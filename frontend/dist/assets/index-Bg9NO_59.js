var Qs=Object.defineProperty,Ks=Object.defineProperties;var Gs=Object.getOwnPropertyDescriptors;var wn=Object.getOwnPropertySymbols;var Xs=Object.prototype.hasOwnProperty,Zs=Object.prototype.propertyIsEnumerable;var Be=(n,e)=>(e=Symbol[n])?e:Symbol.for("Symbol."+n),er=n=>{throw TypeError(n)};var vn=(n,e,s)=>e in n?Qs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,ne=(n,e)=>{for(var s in e||(e={}))Xs.call(e,s)&&vn(n,s,e[s]);if(wn)for(var s of wn(e))Zs.call(e,s)&&vn(n,s,e[s]);return n},fe=(n,e)=>Ks(n,Gs(e));var q=(n,e,s)=>new Promise((r,a)=>{var l=c=>{try{h(s.next(c))}catch(o){a(o)}},d=c=>{try{h(s.throw(c))}catch(o){a(o)}},h=c=>c.done?r(c.value):Promise.resolve(c.value).then(l,d);h((s=s.apply(n,e)).next())}),Pe=function(n,e){this[0]=n,this[1]=e},It=(n,e,s)=>{var r=(d,h,c,o)=>{try{var i=s[d](h),u=(h=i.value)instanceof Pe,p=i.done;Promise.resolve(u?h[0]:h).then(y=>u?r(d==="return"?d:"next",h[1]?{done:y.done,value:y.value}:y,c,o):c({value:y,done:p})).catch(y=>r("throw",y,c,o))}catch(y){o(y)}},a=d=>l[d]=h=>new Promise((c,o)=>r(d,h,c,o)),l={};return s=s.apply(n,e),l[Be("asyncIterator")]=()=>l,a("next"),a("throw"),a("return"),l},Ft=n=>{var e=n[Be("asyncIterator")],s=!1,r,a={};return e==null?(e=n[Be("iterator")](),r=l=>a[l]=d=>e[l](d)):(e=e.call(n),r=l=>a[l]=d=>{if(s){if(s=!1,l==="throw")throw d;return d}return s=!0,{done:!1,value:new Pe(new Promise(h=>{var c=e[l](d);c instanceof Object||er("Object expected"),h(c)}),1)}}),a[Be("iterator")]=()=>a,r("next"),"throw"in e?r("throw"):a.throw=l=>{throw l},"return"in e&&r("return"),a},Cn=(n,e,s)=>(e=n[Be("asyncIterator")])?e.call(n):(n=n[Be("iterator")](),e={},s=(r,a)=>(a=n[r])&&(e[r]=l=>new Promise((d,h,c)=>(l=a.call(n,l),c=l.done,Promise.resolve(l.value).then(o=>d({value:o,done:c}),h)))),s("next"),s("return"),e);import{j as t,C as xe,B as Z,S as H,T as j,G as A,a as re,b as ae,c as tr,D as ts,d as U,e as ns,f as Re,L as Jt,g as ft,h as De,i as Te,k as nr,l as z,M as G,m as Qt,n as Kt,o as Se,p as Q,q as Gt,F as yt,r as Sn,s as _n,I as En,t as Rn,u as bt,v as jt,w as wt,x as vt,A as ze,y as sr,z as rr,E as ar,H as zt,J as ir,K as An,N as or,O as lr,P as cr,V as dr,Q as ur,R as hr,U as fr,W as mr}from"./mui-C-WAG5RB.js";import{c as pr,d as xr,e as gr,r as w,u as Et,f as Xt,L as Ee,h as yr,a as Ue,i as br,j as ke,B as jr}from"./vendor-CgeKSuOn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=s(a);fetch(a.href,l)}})();var Wt={},On=pr;Wt.createRoot=On.createRoot,Wt.hydrateRoot=On.hydrateRoot;var ss={exports:{}};(function(n,e){(function(s,r){n.exports=r()})(xr,function(){var s=1e3,r=6e4,a=36e5,l="millisecond",d="second",h="minute",c="hour",o="day",i="week",u="month",p="quarter",y="year",f="date",b="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,O={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var R=["th","st","nd","rd"],v=T%100;return"["+T+(R[(v-20)%10]||R[v]||R[0])+"]"}},C=function(T,R,v){var D=String(T);return!D||D.length>=R?T:""+Array(R+1-D.length).join(v)+T},k={s:C,z:function(T){var R=-T.utcOffset(),v=Math.abs(R),D=Math.floor(v/60),_=v%60;return(R<=0?"+":"-")+C(D,2,"0")+":"+C(_,2,"0")},m:function T(R,v){if(R.date()<v.date())return-T(v,R);var D=12*(v.year()-R.year())+(v.month()-R.month()),_=R.clone().add(D,u),$=v-_<0,L=R.clone().add(D+($?-1:1),u);return+(-(D+(v-_)/($?_-L:L-_))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:u,y,w:i,d:o,D:f,h:c,m:h,s:d,ms:l,Q:p}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},N="en",J={};J[N]=O;var te="$isDayjsObject",de=function(T){return T instanceof V||!(!T||!T[te])},P=function T(R,v,D){var _;if(!R)return N;if(typeof R=="string"){var $=R.toLowerCase();J[$]&&(_=$),v&&(J[$]=v,_=$);var L=R.split("-");if(!_&&L.length>1)return T(L[0])}else{var M=R.name;J[M]=R,_=M}return!D&&_&&(N=_),_||!D&&N},I=function(T,R){if(de(T))return T.clone();var v=typeof R=="object"?R:{};return v.date=T,v.args=arguments,new V(v)},E=k;E.l=P,E.i=de,E.w=function(T,R){return I(T,{locale:R.$L,utc:R.$u,x:R.$x,$offset:R.$offset})};var V=function(){function T(v){this.$L=P(v.locale,null,!0),this.parse(v),this.$x=this.$x||v.x||{},this[te]=!0}var R=T.prototype;return R.parse=function(v){this.$d=function(D){var _=D.date,$=D.utc;if(_===null)return new Date(NaN);if(E.u(_))return new Date;if(_ instanceof Date)return new Date(_);if(typeof _=="string"&&!/Z$/i.test(_)){var L=_.match(g);if(L){var M=L[2]-1||0,W=(L[7]||"0").substring(0,3);return $?new Date(Date.UTC(L[1],M,L[3]||1,L[4]||0,L[5]||0,L[6]||0,W)):new Date(L[1],M,L[3]||1,L[4]||0,L[5]||0,L[6]||0,W)}}return new Date(_)}(v),this.init()},R.init=function(){var v=this.$d;this.$y=v.getFullYear(),this.$M=v.getMonth(),this.$D=v.getDate(),this.$W=v.getDay(),this.$H=v.getHours(),this.$m=v.getMinutes(),this.$s=v.getSeconds(),this.$ms=v.getMilliseconds()},R.$utils=function(){return E},R.isValid=function(){return this.$d.toString()!==b},R.isSame=function(v,D){var _=I(v);return this.startOf(D)<=_&&_<=this.endOf(D)},R.isAfter=function(v,D){return I(v)<this.startOf(D)},R.isBefore=function(v,D){return this.endOf(D)<I(v)},R.$g=function(v,D,_){return E.u(v)?this[D]:this.set(_,v)},R.unix=function(){return Math.floor(this.valueOf()/1e3)},R.valueOf=function(){return this.$d.getTime()},R.startOf=function(v,D){var _=this,$=!!E.u(D)||D,L=E.p(v),M=function(je,le){var ge=E.w(_.$u?Date.UTC(_.$y,le,je):new Date(_.$y,le,je),_);return $?ge:ge.endOf(o)},W=function(je,le){return E.w(_.toDate()[je].apply(_.toDate("s"),($?[0,0,0,0]:[23,59,59,999]).slice(le)),_)},F=this.$W,K=this.$M,oe=this.$D,ve="set"+(this.$u?"UTC":"");switch(L){case y:return $?M(1,0):M(31,11);case u:return $?M(1,K):M(0,K+1);case i:var be=this.$locale().weekStart||0,_e=(F<be?F+7:F)-be;return M($?oe-_e:oe+(6-_e),K);case o:case f:return W(ve+"Hours",0);case c:return W(ve+"Minutes",1);case h:return W(ve+"Seconds",2);case d:return W(ve+"Milliseconds",3);default:return this.clone()}},R.endOf=function(v){return this.startOf(v,!1)},R.$set=function(v,D){var _,$=E.p(v),L="set"+(this.$u?"UTC":""),M=(_={},_[o]=L+"Date",_[f]=L+"Date",_[u]=L+"Month",_[y]=L+"FullYear",_[c]=L+"Hours",_[h]=L+"Minutes",_[d]=L+"Seconds",_[l]=L+"Milliseconds",_)[$],W=$===o?this.$D+(D-this.$W):D;if($===u||$===y){var F=this.clone().set(f,1);F.$d[M](W),F.init(),this.$d=F.set(f,Math.min(this.$D,F.daysInMonth())).$d}else M&&this.$d[M](W);return this.init(),this},R.set=function(v,D){return this.clone().$set(v,D)},R.get=function(v){return this[E.p(v)]()},R.add=function(v,D){var _,$=this;v=Number(v);var L=E.p(D),M=function(K){var oe=I($);return E.w(oe.date(oe.date()+Math.round(K*v)),$)};if(L===u)return this.set(u,this.$M+v);if(L===y)return this.set(y,this.$y+v);if(L===o)return M(1);if(L===i)return M(7);var W=(_={},_[h]=r,_[c]=a,_[d]=s,_)[L]||1,F=this.$d.getTime()+v*W;return E.w(F,this)},R.subtract=function(v,D){return this.add(-1*v,D)},R.format=function(v){var D=this,_=this.$locale();if(!this.isValid())return _.invalidDate||b;var $=v||"YYYY-MM-DDTHH:mm:ssZ",L=E.z(this),M=this.$H,W=this.$m,F=this.$M,K=_.weekdays,oe=_.months,ve=_.meridiem,be=function(le,ge,Ae,Oe){return le&&(le[ge]||le(D,$))||Ae[ge].slice(0,Oe)},_e=function(le){return E.s(M%12||12,le,"0")},je=ve||function(le,ge,Ae){var Oe=le<12?"AM":"PM";return Ae?Oe.toLowerCase():Oe};return $.replace(S,function(le,ge){return ge||function(Ae){switch(Ae){case"YY":return String(D.$y).slice(-2);case"YYYY":return E.s(D.$y,4,"0");case"M":return F+1;case"MM":return E.s(F+1,2,"0");case"MMM":return be(_.monthsShort,F,oe,3);case"MMMM":return be(oe,F);case"D":return D.$D;case"DD":return E.s(D.$D,2,"0");case"d":return String(D.$W);case"dd":return be(_.weekdaysMin,D.$W,K,2);case"ddd":return be(_.weekdaysShort,D.$W,K,3);case"dddd":return K[D.$W];case"H":return String(M);case"HH":return E.s(M,2,"0");case"h":return _e(1);case"hh":return _e(2);case"a":return je(M,W,!0);case"A":return je(M,W,!1);case"m":return String(W);case"mm":return E.s(W,2,"0");case"s":return String(D.$s);case"ss":return E.s(D.$s,2,"0");case"SSS":return E.s(D.$ms,3,"0");case"Z":return L}return null}(le)||L.replace(":","")})},R.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},R.diff=function(v,D,_){var $,L=this,M=E.p(D),W=I(v),F=(W.utcOffset()-this.utcOffset())*r,K=this-W,oe=function(){return E.m(L,W)};switch(M){case y:$=oe()/12;break;case u:$=oe();break;case p:$=oe()/3;break;case i:$=(K-F)/6048e5;break;case o:$=(K-F)/864e5;break;case c:$=K/a;break;case h:$=K/r;break;case d:$=K/s;break;default:$=K}return _?$:E.a($)},R.daysInMonth=function(){return this.endOf(u).$D},R.$locale=function(){return J[this.$L]},R.locale=function(v,D){if(!v)return this.$L;var _=this.clone(),$=P(v,D,!0);return $&&(_.$L=$),_},R.clone=function(){return E.w(this.$d,this)},R.toDate=function(){return new Date(this.valueOf())},R.toJSON=function(){return this.isValid()?this.toISOString():null},R.toISOString=function(){return this.$d.toISOString()},R.toString=function(){return this.$d.toUTCString()},T}(),ee=V.prototype;return I.prototype=ee,[["$ms",l],["$s",d],["$m",h],["$H",c],["$W",o],["$M",u],["$y",y],["$D",f]].forEach(function(T){ee[T[1]]=function(R){return this.$g(R,T[0],T[1])}}),I.extend=function(T,R){return T.$i||(T(R,V,I),T.$i=!0),I},I.locale=P,I.isDayjs=de,I.unix=function(T){return I(1e3*T)},I.en=J[N],I.Ls=J,I.p={},I})})(ss);var wr=ss.exports;const se=gr(wr);function rs(n,e){return function(){return n.apply(e,arguments)}}const{toString:vr}=Object.prototype,{getPrototypeOf:Zt}=Object,{iterator:Rt,toStringTag:as}=Symbol,At=(n=>e=>{const s=vr.call(e);return n[s]||(n[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),ye=n=>(n=n.toLowerCase(),e=>At(e)===n),Ot=n=>e=>typeof e===n,{isArray:He}=Array,We=Ot("undefined");function Ge(n){return n!==null&&!We(n)&&n.constructor!==null&&!We(n.constructor)&&me(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const is=ye("ArrayBuffer");function Cr(n){let e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&is(n.buffer),e}const Sr=Ot("string"),me=Ot("function"),os=Ot("number"),Xe=n=>n!==null&&typeof n=="object",_r=n=>n===!0||n===!1,mt=n=>{if(At(n)!=="object")return!1;const e=Zt(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(as in n)&&!(Rt in n)},Er=n=>{if(!Xe(n)||Ge(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch(e){return!1}},Rr=ye("Date"),Ar=ye("File"),Or=ye("Blob"),Mr=ye("FileList"),Pr=n=>Xe(n)&&me(n.pipe),kr=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||me(n.append)&&((e=At(n))==="formdata"||e==="object"&&me(n.toString)&&n.toString()==="[object FormData]"))},Dr=ye("URLSearchParams"),[Tr,Nr,Ir,Fr]=["ReadableStream","Request","Response","Headers"].map(ye),Lr=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ze(n,e,{allOwnKeys:s=!1}={}){if(n===null||typeof n=="undefined")return;let r,a;if(typeof n!="object"&&(n=[n]),He(n))for(r=0,a=n.length;r<a;r++)e.call(null,n[r],r,n);else{if(Ge(n))return;const l=s?Object.getOwnPropertyNames(n):Object.keys(n),d=l.length;let h;for(r=0;r<d;r++)h=l[r],e.call(null,n[h],h,n)}}function ls(n,e){if(Ge(n))return null;e=e.toLowerCase();const s=Object.keys(n);let r=s.length,a;for(;r-- >0;)if(a=s[r],e===a.toLowerCase())return a;return null}const Ne=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,cs=n=>!We(n)&&n!==Ne;function Ht(){const{caseless:n,skipUndefined:e}=cs(this)&&this||{},s={},r=(a,l)=>{const d=n&&ls(s,l)||l;mt(s[d])&&mt(a)?s[d]=Ht(s[d],a):mt(a)?s[d]=Ht({},a):He(a)?s[d]=a.slice():(!e||!We(a))&&(s[d]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Ze(arguments[a],r);return s}const $r=(n,e,s,{allOwnKeys:r}={})=>(Ze(e,(a,l)=>{s&&me(a)?n[l]=rs(a,s):n[l]=a},{allOwnKeys:r}),n),Br=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Ur=(n,e,s,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),s&&Object.assign(n.prototype,s)},zr=(n,e,s,r)=>{let a,l,d;const h={};if(e=e||{},n==null)return e;do{for(a=Object.getOwnPropertyNames(n),l=a.length;l-- >0;)d=a[l],(!r||r(d,n,e))&&!h[d]&&(e[d]=n[d],h[d]=!0);n=s!==!1&&Zt(n)}while(n&&(!s||s(n,e))&&n!==Object.prototype);return e},Wr=(n,e,s)=>{n=String(n),(s===void 0||s>n.length)&&(s=n.length),s-=e.length;const r=n.indexOf(e,s);return r!==-1&&r===s},Hr=n=>{if(!n)return null;if(He(n))return n;let e=n.length;if(!os(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=n[e];return s},Yr=(n=>e=>n&&e instanceof n)(typeof Uint8Array!="undefined"&&Zt(Uint8Array)),qr=(n,e)=>{const r=(n&&n[Rt]).call(n);let a;for(;(a=r.next())&&!a.done;){const l=a.value;e.call(n,l[0],l[1])}},Vr=(n,e)=>{let s;const r=[];for(;(s=n.exec(e))!==null;)r.push(s);return r},Jr=ye("HTMLFormElement"),Qr=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,a){return r.toUpperCase()+a}),Mn=(({hasOwnProperty:n})=>(e,s)=>n.call(e,s))(Object.prototype),Kr=ye("RegExp"),ds=(n,e)=>{const s=Object.getOwnPropertyDescriptors(n),r={};Ze(s,(a,l)=>{let d;(d=e(a,l,n))!==!1&&(r[l]=d||a)}),Object.defineProperties(n,r)},Gr=n=>{ds(n,(e,s)=>{if(me(n)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=n[s];if(me(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},Xr=(n,e)=>{const s={},r=a=>{a.forEach(l=>{s[l]=!0})};return He(n)?r(n):r(String(n).split(e)),s},Zr=()=>{},ea=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function ta(n){return!!(n&&me(n.append)&&n[as]==="FormData"&&n[Rt])}const na=n=>{const e=new Array(10),s=(r,a)=>{if(Xe(r)){if(e.indexOf(r)>=0)return;if(Ge(r))return r;if(!("toJSON"in r)){e[a]=r;const l=He(r)?[]:{};return Ze(r,(d,h)=>{const c=s(d,a+1);!We(c)&&(l[h]=c)}),e[a]=void 0,l}}return r};return s(n,0)},sa=ye("AsyncFunction"),ra=n=>n&&(Xe(n)||me(n))&&me(n.then)&&me(n.catch),us=((n,e)=>n?setImmediate:e?((s,r)=>(Ne.addEventListener("message",({source:a,data:l})=>{a===Ne&&l===s&&r.length&&r.shift()()},!1),a=>{r.push(a),Ne.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",me(Ne.postMessage)),aa=typeof queueMicrotask!="undefined"?queueMicrotask.bind(Ne):typeof process!="undefined"&&process.nextTick||us,ia=n=>n!=null&&me(n[Rt]),x={isArray:He,isArrayBuffer:is,isBuffer:Ge,isFormData:kr,isArrayBufferView:Cr,isString:Sr,isNumber:os,isBoolean:_r,isObject:Xe,isPlainObject:mt,isEmptyObject:Er,isReadableStream:Tr,isRequest:Nr,isResponse:Ir,isHeaders:Fr,isUndefined:We,isDate:Rr,isFile:Ar,isBlob:Or,isRegExp:Kr,isFunction:me,isStream:Pr,isURLSearchParams:Dr,isTypedArray:Yr,isFileList:Mr,forEach:Ze,merge:Ht,extend:$r,trim:Lr,stripBOM:Br,inherits:Ur,toFlatObject:zr,kindOf:At,kindOfTest:ye,endsWith:Wr,toArray:Hr,forEachEntry:qr,matchAll:Vr,isHTMLForm:Jr,hasOwnProperty:Mn,hasOwnProp:Mn,reduceDescriptors:ds,freezeMethods:Gr,toObjectSet:Xr,toCamelCase:Qr,noop:Zr,toFiniteNumber:ea,findKey:ls,global:Ne,isContextDefined:cs,isSpecCompliantForm:ta,toJSONObject:na,isAsyncFn:sa,isThenable:ra,setImmediate:us,asap:aa,isIterable:ia};function Y(n,e,s,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}x.inherits(Y,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:x.toJSONObject(this.config),code:this.code,status:this.status}}});const hs=Y.prototype,fs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{fs[n]={value:n}});Object.defineProperties(Y,fs);Object.defineProperty(hs,"isAxiosError",{value:!0});Y.from=(n,e,s,r,a,l)=>{const d=Object.create(hs);x.toFlatObject(n,d,function(i){return i!==Error.prototype},o=>o!=="isAxiosError");const h=n&&n.message?n.message:"Error",c=e==null&&n?n.code:e;return Y.call(d,h,c,s,r,a),n&&d.cause==null&&Object.defineProperty(d,"cause",{value:n,configurable:!0}),d.name=n&&n.name||"Error",l&&Object.assign(d,l),d};const oa=null;function Yt(n){return x.isPlainObject(n)||x.isArray(n)}function ms(n){return x.endsWith(n,"[]")?n.slice(0,-2):n}function Pn(n,e,s){return n?n.concat(e).map(function(a,l){return a=ms(a),!s&&l?"["+a+"]":a}).join(s?".":""):e}function la(n){return x.isArray(n)&&!n.some(Yt)}const ca=x.toFlatObject(x,{},null,function(e){return/^is[A-Z]/.test(e)});function Mt(n,e,s){if(!x.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,s=x.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,g){return!x.isUndefined(g[b])});const r=s.metaTokens,a=s.visitor||i,l=s.dots,d=s.indexes,c=(s.Blob||typeof Blob!="undefined"&&Blob)&&x.isSpecCompliantForm(e);if(!x.isFunction(a))throw new TypeError("visitor must be a function");function o(f){if(f===null)return"";if(x.isDate(f))return f.toISOString();if(x.isBoolean(f))return f.toString();if(!c&&x.isBlob(f))throw new Y("Blob is not supported. Use a Buffer instead.");return x.isArrayBuffer(f)||x.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function i(f,b,g){let S=f;if(f&&!g&&typeof f=="object"){if(x.endsWith(b,"{}"))b=r?b:b.slice(0,-2),f=JSON.stringify(f);else if(x.isArray(f)&&la(f)||(x.isFileList(f)||x.endsWith(b,"[]"))&&(S=x.toArray(f)))return b=ms(b),S.forEach(function(C,k){!(x.isUndefined(C)||C===null)&&e.append(d===!0?Pn([b],k,l):d===null?b:b+"[]",o(C))}),!1}return Yt(f)?!0:(e.append(Pn(g,b,l),o(f)),!1)}const u=[],p=Object.assign(ca,{defaultVisitor:i,convertValue:o,isVisitable:Yt});function y(f,b){if(!x.isUndefined(f)){if(u.indexOf(f)!==-1)throw Error("Circular reference detected in "+b.join("."));u.push(f),x.forEach(f,function(S,O){(!(x.isUndefined(S)||S===null)&&a.call(e,S,x.isString(O)?O.trim():O,b,p))===!0&&y(S,b?b.concat(O):[O])}),u.pop()}}if(!x.isObject(n))throw new TypeError("data must be an object");return y(n),e}function kn(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function en(n,e){this._pairs=[],n&&Mt(n,this,e)}const ps=en.prototype;ps.append=function(e,s){this._pairs.push([e,s])};ps.toString=function(e){const s=e?function(r){return e.call(this,r,kn)}:kn;return this._pairs.map(function(a){return s(a[0])+"="+s(a[1])},"").join("&")};function da(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function xs(n,e,s){if(!e)return n;const r=s&&s.encode||da;x.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let l;if(a?l=a(e,s):l=x.isURLSearchParams(e)?e.toString():new en(e,s).toString(r),l){const d=n.indexOf("#");d!==-1&&(n=n.slice(0,d)),n+=(n.indexOf("?")===-1?"?":"&")+l}return n}class Dn{constructor(){this.handlers=[]}use(e,s,r){return this.handlers.push({fulfilled:e,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){x.forEach(this.handlers,function(r){r!==null&&e(r)})}}const gs={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ua=typeof URLSearchParams!="undefined"?URLSearchParams:en,ha=typeof FormData!="undefined"?FormData:null,fa=typeof Blob!="undefined"?Blob:null,ma={isBrowser:!0,classes:{URLSearchParams:ua,FormData:ha,Blob:fa},protocols:["http","https","file","blob","url","data"]},tn=typeof window!="undefined"&&typeof document!="undefined",qt=typeof navigator=="object"&&navigator||void 0,pa=tn&&(!qt||["ReactNative","NativeScript","NS"].indexOf(qt.product)<0),xa=typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ga=tn&&window.location.href||"http://localhost",ya=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:tn,hasStandardBrowserEnv:pa,hasStandardBrowserWebWorkerEnv:xa,navigator:qt,origin:ga},Symbol.toStringTag,{value:"Module"})),ce=ne(ne({},ya),ma);function ba(n,e){return Mt(n,new ce.classes.URLSearchParams,ne({visitor:function(s,r,a,l){return ce.isNode&&x.isBuffer(s)?(this.append(r,s.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},e))}function ja(n){return x.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function wa(n){const e={},s=Object.keys(n);let r;const a=s.length;let l;for(r=0;r<a;r++)l=s[r],e[l]=n[l];return e}function ys(n){function e(s,r,a,l){let d=s[l++];if(d==="__proto__")return!0;const h=Number.isFinite(+d),c=l>=s.length;return d=!d&&x.isArray(a)?a.length:d,c?(x.hasOwnProp(a,d)?a[d]=[a[d],r]:a[d]=r,!h):((!a[d]||!x.isObject(a[d]))&&(a[d]=[]),e(s,r,a[d],l)&&x.isArray(a[d])&&(a[d]=wa(a[d])),!h)}if(x.isFormData(n)&&x.isFunction(n.entries)){const s={};return x.forEachEntry(n,(r,a)=>{e(ja(r),a,s,0)}),s}return null}function va(n,e,s){if(x.isString(n))try{return(e||JSON.parse)(n),x.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(n)}const et={transitional:gs,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const r=s.getContentType()||"",a=r.indexOf("application/json")>-1,l=x.isObject(e);if(l&&x.isHTMLForm(e)&&(e=new FormData(e)),x.isFormData(e))return a?JSON.stringify(ys(e)):e;if(x.isArrayBuffer(e)||x.isBuffer(e)||x.isStream(e)||x.isFile(e)||x.isBlob(e)||x.isReadableStream(e))return e;if(x.isArrayBufferView(e))return e.buffer;if(x.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let h;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return ba(e,this.formSerializer).toString();if((h=x.isFileList(e))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Mt(h?{"files[]":e}:e,c&&new c,this.formSerializer)}}return l||a?(s.setContentType("application/json",!1),va(e)):e}],transformResponse:[function(e){const s=this.transitional||et.transitional,r=s&&s.forcedJSONParsing,a=this.responseType==="json";if(x.isResponse(e)||x.isReadableStream(e))return e;if(e&&x.isString(e)&&(r&&!this.responseType||a)){const d=!(s&&s.silentJSONParsing)&&a;try{return JSON.parse(e,this.parseReviver)}catch(h){if(d)throw h.name==="SyntaxError"?Y.from(h,Y.ERR_BAD_RESPONSE,this,null,this.response):h}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ce.classes.FormData,Blob:ce.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};x.forEach(["delete","get","head","post","put","patch"],n=>{et.headers[n]={}});const Ca=x.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Sa=n=>{const e={};let s,r,a;return n&&n.split(`
`).forEach(function(d){a=d.indexOf(":"),s=d.substring(0,a).trim().toLowerCase(),r=d.substring(a+1).trim(),!(!s||e[s]&&Ca[s])&&(s==="set-cookie"?e[s]?e[s].push(r):e[s]=[r]:e[s]=e[s]?e[s]+", "+r:r)}),e},Tn=Symbol("internals");function Qe(n){return n&&String(n).trim().toLowerCase()}function pt(n){return n===!1||n==null?n:x.isArray(n)?n.map(pt):String(n)}function _a(n){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(n);)e[r[1]]=r[2];return e}const Ea=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Lt(n,e,s,r,a){if(x.isFunction(r))return r.call(this,e,s);if(a&&(e=s),!!x.isString(e)){if(x.isString(r))return e.indexOf(r)!==-1;if(x.isRegExp(r))return r.test(e)}}function Ra(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,r)=>s.toUpperCase()+r)}function Aa(n,e){const s=x.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+s,{value:function(a,l,d){return this[r].call(this,e,a,l,d)},configurable:!0})})}let pe=class{constructor(e){e&&this.set(e)}set(e,s,r){const a=this;function l(h,c,o){const i=Qe(c);if(!i)throw new Error("header name must be a non-empty string");const u=x.findKey(a,i);(!u||a[u]===void 0||o===!0||o===void 0&&a[u]!==!1)&&(a[u||c]=pt(h))}const d=(h,c)=>x.forEach(h,(o,i)=>l(o,i,c));if(x.isPlainObject(e)||e instanceof this.constructor)d(e,s);else if(x.isString(e)&&(e=e.trim())&&!Ea(e))d(Sa(e),s);else if(x.isObject(e)&&x.isIterable(e)){let h={},c,o;for(const i of e){if(!x.isArray(i))throw TypeError("Object iterator must return a key-value pair");h[o=i[0]]=(c=h[o])?x.isArray(c)?[...c,i[1]]:[c,i[1]]:i[1]}d(h,s)}else e!=null&&l(s,e,r);return this}get(e,s){if(e=Qe(e),e){const r=x.findKey(this,e);if(r){const a=this[r];if(!s)return a;if(s===!0)return _a(a);if(x.isFunction(s))return s.call(this,a,r);if(x.isRegExp(s))return s.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=Qe(e),e){const r=x.findKey(this,e);return!!(r&&this[r]!==void 0&&(!s||Lt(this,this[r],r,s)))}return!1}delete(e,s){const r=this;let a=!1;function l(d){if(d=Qe(d),d){const h=x.findKey(r,d);h&&(!s||Lt(r,r[h],h,s))&&(delete r[h],a=!0)}}return x.isArray(e)?e.forEach(l):l(e),a}clear(e){const s=Object.keys(this);let r=s.length,a=!1;for(;r--;){const l=s[r];(!e||Lt(this,this[l],l,e,!0))&&(delete this[l],a=!0)}return a}normalize(e){const s=this,r={};return x.forEach(this,(a,l)=>{const d=x.findKey(r,l);if(d){s[d]=pt(a),delete s[l];return}const h=e?Ra(l):String(l).trim();h!==l&&delete s[l],s[h]=pt(a),r[h]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return x.forEach(this,(r,a)=>{r!=null&&r!==!1&&(s[a]=e&&x.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const r=new this(e);return s.forEach(a=>r.set(a)),r}static accessor(e){const r=(this[Tn]=this[Tn]={accessors:{}}).accessors,a=this.prototype;function l(d){const h=Qe(d);r[h]||(Aa(a,d),r[h]=!0)}return x.isArray(e)?e.forEach(l):l(e),this}};pe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);x.reduceDescriptors(pe.prototype,({value:n},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[s]=r}}});x.freezeMethods(pe);function $t(n,e){const s=this||et,r=e||s,a=pe.from(r.headers);let l=r.data;return x.forEach(n,function(h){l=h.call(s,l,a.normalize(),e?e.status:void 0)}),a.normalize(),l}function bs(n){return!!(n&&n.__CANCEL__)}function Ye(n,e,s){Y.call(this,n==null?"canceled":n,Y.ERR_CANCELED,e,s),this.name="CanceledError"}x.inherits(Ye,Y,{__CANCEL__:!0});function js(n,e,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?n(s):e(new Y("Request failed with status code "+s.status,[Y.ERR_BAD_REQUEST,Y.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Oa(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Ma(n,e){n=n||10;const s=new Array(n),r=new Array(n);let a=0,l=0,d;return e=e!==void 0?e:1e3,function(c){const o=Date.now(),i=r[l];d||(d=o),s[a]=c,r[a]=o;let u=l,p=0;for(;u!==a;)p+=s[u++],u=u%n;if(a=(a+1)%n,a===l&&(l=(l+1)%n),o-d<e)return;const y=i&&o-i;return y?Math.round(p*1e3/y):void 0}}function Pa(n,e){let s=0,r=1e3/e,a,l;const d=(o,i=Date.now())=>{s=i,a=null,l&&(clearTimeout(l),l=null),n(...o)};return[(...o)=>{const i=Date.now(),u=i-s;u>=r?d(o,i):(a=o,l||(l=setTimeout(()=>{l=null,d(a)},r-u)))},()=>a&&d(a)]}const Ct=(n,e,s=3)=>{let r=0;const a=Ma(50,250);return Pa(l=>{const d=l.loaded,h=l.lengthComputable?l.total:void 0,c=d-r,o=a(c),i=d<=h;r=d;const u={loaded:d,total:h,progress:h?d/h:void 0,bytes:c,rate:o||void 0,estimated:o&&h&&i?(h-d)/o:void 0,event:l,lengthComputable:h!=null,[e?"download":"upload"]:!0};n(u)},s)},Nn=(n,e)=>{const s=n!=null;return[r=>e[0]({lengthComputable:s,total:n,loaded:r}),e[1]]},In=n=>(...e)=>x.asap(()=>n(...e)),ka=ce.hasStandardBrowserEnv?((n,e)=>s=>(s=new URL(s,ce.origin),n.protocol===s.protocol&&n.host===s.host&&(e||n.port===s.port)))(new URL(ce.origin),ce.navigator&&/(msie|trident)/i.test(ce.navigator.userAgent)):()=>!0,Da=ce.hasStandardBrowserEnv?{write(n,e,s,r,a,l,d){if(typeof document=="undefined")return;const h=[`${n}=${encodeURIComponent(e)}`];x.isNumber(s)&&h.push(`expires=${new Date(s).toUTCString()}`),x.isString(r)&&h.push(`path=${r}`),x.isString(a)&&h.push(`domain=${a}`),l===!0&&h.push("secure"),x.isString(d)&&h.push(`SameSite=${d}`),document.cookie=h.join("; ")},read(n){if(typeof document=="undefined")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Ta(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Na(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function ws(n,e,s){let r=!Ta(e);return n&&(r||s==!1)?Na(n,e):e}const Fn=n=>n instanceof pe?ne({},n):n;function Fe(n,e){e=e||{};const s={};function r(o,i,u,p){return x.isPlainObject(o)&&x.isPlainObject(i)?x.merge.call({caseless:p},o,i):x.isPlainObject(i)?x.merge({},i):x.isArray(i)?i.slice():i}function a(o,i,u,p){if(x.isUndefined(i)){if(!x.isUndefined(o))return r(void 0,o,u,p)}else return r(o,i,u,p)}function l(o,i){if(!x.isUndefined(i))return r(void 0,i)}function d(o,i){if(x.isUndefined(i)){if(!x.isUndefined(o))return r(void 0,o)}else return r(void 0,i)}function h(o,i,u){if(u in e)return r(o,i);if(u in n)return r(void 0,o)}const c={url:l,method:l,data:l,baseURL:d,transformRequest:d,transformResponse:d,paramsSerializer:d,timeout:d,timeoutMessage:d,withCredentials:d,withXSRFToken:d,adapter:d,responseType:d,xsrfCookieName:d,xsrfHeaderName:d,onUploadProgress:d,onDownloadProgress:d,decompress:d,maxContentLength:d,maxBodyLength:d,beforeRedirect:d,transport:d,httpAgent:d,httpsAgent:d,cancelToken:d,socketPath:d,responseEncoding:d,validateStatus:h,headers:(o,i,u)=>a(Fn(o),Fn(i),u,!0)};return x.forEach(Object.keys(ne(ne({},n),e)),function(i){const u=c[i]||a,p=u(n[i],e[i],i);x.isUndefined(p)&&u!==h||(s[i]=p)}),s}const vs=n=>{const e=Fe({},n);let{data:s,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:l,headers:d,auth:h}=e;if(e.headers=d=pe.from(d),e.url=xs(ws(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),h&&d.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):""))),x.isFormData(s)){if(ce.hasStandardBrowserEnv||ce.hasStandardBrowserWebWorkerEnv)d.setContentType(void 0);else if(x.isFunction(s.getHeaders)){const c=s.getHeaders(),o=["content-type","content-length"];Object.entries(c).forEach(([i,u])=>{o.includes(i.toLowerCase())&&d.set(i,u)})}}if(ce.hasStandardBrowserEnv&&(r&&x.isFunction(r)&&(r=r(e)),r||r!==!1&&ka(e.url))){const c=a&&l&&Da.read(l);c&&d.set(a,c)}return e},Ia=typeof XMLHttpRequest!="undefined",Fa=Ia&&function(n){return new Promise(function(s,r){const a=vs(n);let l=a.data;const d=pe.from(a.headers).normalize();let{responseType:h,onUploadProgress:c,onDownloadProgress:o}=a,i,u,p,y,f;function b(){y&&y(),f&&f(),a.cancelToken&&a.cancelToken.unsubscribe(i),a.signal&&a.signal.removeEventListener("abort",i)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function S(){if(!g)return;const C=pe.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),N={data:!h||h==="text"||h==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:C,config:n,request:g};js(function(te){s(te),b()},function(te){r(te),b()},N),g=null}"onloadend"in g?g.onloadend=S:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(S)},g.onabort=function(){g&&(r(new Y("Request aborted",Y.ECONNABORTED,n,g)),g=null)},g.onerror=function(k){const N=k&&k.message?k.message:"Network Error",J=new Y(N,Y.ERR_NETWORK,n,g);J.event=k||null,r(J),g=null},g.ontimeout=function(){let k=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const N=a.transitional||gs;a.timeoutErrorMessage&&(k=a.timeoutErrorMessage),r(new Y(k,N.clarifyTimeoutError?Y.ETIMEDOUT:Y.ECONNABORTED,n,g)),g=null},l===void 0&&d.setContentType(null),"setRequestHeader"in g&&x.forEach(d.toJSON(),function(k,N){g.setRequestHeader(N,k)}),x.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),h&&h!=="json"&&(g.responseType=a.responseType),o&&([p,f]=Ct(o,!0),g.addEventListener("progress",p)),c&&g.upload&&([u,y]=Ct(c),g.upload.addEventListener("progress",u),g.upload.addEventListener("loadend",y)),(a.cancelToken||a.signal)&&(i=C=>{g&&(r(!C||C.type?new Ye(null,n,g):C),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(i),a.signal&&(a.signal.aborted?i():a.signal.addEventListener("abort",i)));const O=Oa(a.url);if(O&&ce.protocols.indexOf(O)===-1){r(new Y("Unsupported protocol "+O+":",Y.ERR_BAD_REQUEST,n));return}g.send(l||null)})},La=(n,e)=>{const{length:s}=n=n?n.filter(Boolean):[];if(e||s){let r=new AbortController,a;const l=function(o){if(!a){a=!0,h();const i=o instanceof Error?o:this.reason;r.abort(i instanceof Y?i:new Ye(i instanceof Error?i.message:i))}};let d=e&&setTimeout(()=>{d=null,l(new Y(`timeout ${e} of ms exceeded`,Y.ETIMEDOUT))},e);const h=()=>{n&&(d&&clearTimeout(d),d=null,n.forEach(o=>{o.unsubscribe?o.unsubscribe(l):o.removeEventListener("abort",l)}),n=null)};n.forEach(o=>o.addEventListener("abort",l));const{signal:c}=r;return c.unsubscribe=()=>x.asap(h),c}},$a=function*(n,e){let s=n.byteLength;if(s<e){yield n;return}let r=0,a;for(;r<s;)a=r+e,yield n.slice(r,a),r=a},Ba=function(n,e){return It(this,null,function*(){try{for(var s=Cn(Ua(n)),r,a,l;r=!(a=yield new Pe(s.next())).done;r=!1){const d=a.value;yield*Ft($a(d,e))}}catch(a){l=[a]}finally{try{r&&(a=s.return)&&(yield new Pe(a.call(s)))}finally{if(l)throw l[0]}}})},Ua=function(n){return It(this,null,function*(){if(n[Symbol.asyncIterator]){yield*Ft(n);return}const e=n.getReader();try{for(;;){const{done:s,value:r}=yield new Pe(e.read());if(s)break;yield r}}finally{yield new Pe(e.cancel())}})},Ln=(n,e,s,r)=>{const a=Ba(n,e);let l=0,d,h=o=>{d||(d=!0,r&&r(o))};return new ReadableStream({pull(o){return q(this,null,function*(){try{const{done:i,value:u}=yield a.next();if(i){h(),o.close();return}let p=u.byteLength;if(s){let y=l+=p;s(y)}o.enqueue(new Uint8Array(u))}catch(i){throw h(i),i}})},cancel(o){return h(o),a.return()}},{highWaterMark:2})},$n=64*1024,{isFunction:ct}=x,za=(({Request:n,Response:e})=>({Request:n,Response:e}))(x.global),{ReadableStream:Bn,TextEncoder:Un}=x.global,zn=(n,...e)=>{try{return!!n(...e)}catch(s){return!1}},Wa=n=>{n=x.merge.call({skipUndefined:!0},za,n);const{fetch:e,Request:s,Response:r}=n,a=e?ct(e):typeof fetch=="function",l=ct(s),d=ct(r);if(!a)return!1;const h=a&&ct(Bn),c=a&&(typeof Un=="function"?(f=>b=>f.encode(b))(new Un):f=>q(void 0,null,function*(){return new Uint8Array(yield new s(f).arrayBuffer())})),o=l&&h&&zn(()=>{let f=!1;const b=new s(ce.origin,{body:new Bn,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!b}),i=d&&h&&zn(()=>x.isReadableStream(new r("").body)),u={stream:i&&(f=>f.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!u[f]&&(u[f]=(b,g)=>{let S=b&&b[f];if(S)return S.call(b);throw new Y(`Response type '${f}' is not supported`,Y.ERR_NOT_SUPPORT,g)})});const p=f=>q(void 0,null,function*(){if(f==null)return 0;if(x.isBlob(f))return f.size;if(x.isSpecCompliantForm(f))return(yield new s(ce.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(x.isArrayBufferView(f)||x.isArrayBuffer(f))return f.byteLength;if(x.isURLSearchParams(f)&&(f=f+""),x.isString(f))return(yield c(f)).byteLength}),y=(f,b)=>q(void 0,null,function*(){const g=x.toFiniteNumber(f.getContentLength());return g==null?p(b):g});return f=>q(void 0,null,function*(){let{url:b,method:g,data:S,signal:O,cancelToken:C,timeout:k,onDownloadProgress:N,onUploadProgress:J,responseType:te,headers:de,withCredentials:P="same-origin",fetchOptions:I}=vs(f),E=e||fetch;te=te?(te+"").toLowerCase():"text";let V=La([O,C&&C.toAbortSignal()],k),ee=null;const T=V&&V.unsubscribe&&(()=>{V.unsubscribe()});let R;try{if(J&&o&&g!=="get"&&g!=="head"&&(R=yield y(de,S))!==0){let M=new s(b,{method:"POST",body:S,duplex:"half"}),W;if(x.isFormData(S)&&(W=M.headers.get("content-type"))&&de.setContentType(W),M.body){const[F,K]=Nn(R,Ct(In(J)));S=Ln(M.body,$n,F,K)}}x.isString(P)||(P=P?"include":"omit");const v=l&&"credentials"in s.prototype,D=fe(ne({},I),{signal:V,method:g.toUpperCase(),headers:de.normalize().toJSON(),body:S,duplex:"half",credentials:v?P:void 0});ee=l&&new s(b,D);let _=yield l?E(ee,I):E(b,D);const $=i&&(te==="stream"||te==="response");if(i&&(N||$&&T)){const M={};["status","statusText","headers"].forEach(oe=>{M[oe]=_[oe]});const W=x.toFiniteNumber(_.headers.get("content-length")),[F,K]=N&&Nn(W,Ct(In(N),!0))||[];_=new r(Ln(_.body,$n,F,()=>{K&&K(),T&&T()}),M)}te=te||"text";let L=yield u[x.findKey(u,te)||"text"](_,f);return!$&&T&&T(),yield new Promise((M,W)=>{js(M,W,{data:L,headers:pe.from(_.headers),status:_.status,statusText:_.statusText,config:f,request:ee})})}catch(v){throw T&&T(),v&&v.name==="TypeError"&&/Load failed|fetch/i.test(v.message)?Object.assign(new Y("Network Error",Y.ERR_NETWORK,f,ee),{cause:v.cause||v}):Y.from(v,v&&v.code,f,ee)}})},Ha=new Map,Cs=n=>{let e=n&&n.env||{};const{fetch:s,Request:r,Response:a}=e,l=[r,a,s];let d=l.length,h=d,c,o,i=Ha;for(;h--;)c=l[h],o=i.get(c),o===void 0&&i.set(c,o=h?new Map:Wa(e)),i=o;return o};Cs();const nn={http:oa,xhr:Fa,fetch:{get:Cs}};x.forEach(nn,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch(s){}Object.defineProperty(n,"adapterName",{value:e})}});const Wn=n=>`- ${n}`,Ya=n=>x.isFunction(n)||n===null||n===!1;function qa(n,e){n=x.isArray(n)?n:[n];const{length:s}=n;let r,a;const l={};for(let d=0;d<s;d++){r=n[d];let h;if(a=r,!Ya(r)&&(a=nn[(h=String(r)).toLowerCase()],a===void 0))throw new Y(`Unknown adapter '${h}'`);if(a&&(x.isFunction(a)||(a=a.get(e))))break;l[h||"#"+d]=a}if(!a){const d=Object.entries(l).map(([c,o])=>`adapter ${c} `+(o===!1?"is not supported by the environment":"is not available in the build"));let h=s?d.length>1?`since :
`+d.map(Wn).join(`
`):" "+Wn(d[0]):"as no adapter specified";throw new Y("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return a}const Ss={getAdapter:qa,adapters:nn};function Bt(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Ye(null,n)}function Hn(n){return Bt(n),n.headers=pe.from(n.headers),n.data=$t.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Ss.getAdapter(n.adapter||et.adapter,n)(n).then(function(r){return Bt(n),r.data=$t.call(n,n.transformResponse,r),r.headers=pe.from(r.headers),r},function(r){return bs(r)||(Bt(n),r&&r.response&&(r.response.data=$t.call(n,n.transformResponse,r.response),r.response.headers=pe.from(r.response.headers))),Promise.reject(r)})}const _s="1.13.2",Pt={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Pt[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const Yn={};Pt.transitional=function(e,s,r){function a(l,d){return"[Axios v"+_s+"] Transitional option '"+l+"'"+d+(r?". "+r:"")}return(l,d,h)=>{if(e===!1)throw new Y(a(d," has been removed"+(s?" in "+s:"")),Y.ERR_DEPRECATED);return s&&!Yn[d]&&(Yn[d]=!0,console.warn(a(d," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(l,d,h):!0}};Pt.spelling=function(e){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function Va(n,e,s){if(typeof n!="object")throw new Y("options must be an object",Y.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let a=r.length;for(;a-- >0;){const l=r[a],d=e[l];if(d){const h=n[l],c=h===void 0||d(h,l,n);if(c!==!0)throw new Y("option "+l+" must be "+c,Y.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new Y("Unknown option "+l,Y.ERR_BAD_OPTION)}}const xt={assertOptions:Va,validators:Pt},we=xt.validators;let Ie=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Dn,response:new Dn}}request(e,s){return q(this,null,function*(){try{return yield this._request(e,s)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch(d){}}throw r}})}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=Fe(this.defaults,s);const{transitional:r,paramsSerializer:a,headers:l}=s;r!==void 0&&xt.assertOptions(r,{silentJSONParsing:we.transitional(we.boolean),forcedJSONParsing:we.transitional(we.boolean),clarifyTimeoutError:we.transitional(we.boolean)},!1),a!=null&&(x.isFunction(a)?s.paramsSerializer={serialize:a}:xt.assertOptions(a,{encode:we.function,serialize:we.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),xt.assertOptions(s,{baseUrl:we.spelling("baseURL"),withXsrfToken:we.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let d=l&&x.merge(l.common,l[s.method]);l&&x.forEach(["delete","get","head","post","put","patch","common"],f=>{delete l[f]}),s.headers=pe.concat(d,l);const h=[];let c=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(s)===!1||(c=c&&b.synchronous,h.unshift(b.fulfilled,b.rejected))});const o=[];this.interceptors.response.forEach(function(b){o.push(b.fulfilled,b.rejected)});let i,u=0,p;if(!c){const f=[Hn.bind(this),void 0];for(f.unshift(...h),f.push(...o),p=f.length,i=Promise.resolve(s);u<p;)i=i.then(f[u++],f[u++]);return i}p=h.length;let y=s;for(;u<p;){const f=h[u++],b=h[u++];try{y=f(y)}catch(g){b.call(this,g);break}}try{i=Hn.call(this,y)}catch(f){return Promise.reject(f)}for(u=0,p=o.length;u<p;)i=i.then(o[u++],o[u++]);return i}getUri(e){e=Fe(this.defaults,e);const s=ws(e.baseURL,e.url,e.allowAbsoluteUrls);return xs(s,e.params,e.paramsSerializer)}};x.forEach(["delete","get","head","options"],function(e){Ie.prototype[e]=function(s,r){return this.request(Fe(r||{},{method:e,url:s,data:(r||{}).data}))}});x.forEach(["post","put","patch"],function(e){function s(r){return function(l,d,h){return this.request(Fe(h||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:d}))}}Ie.prototype[e]=s(),Ie.prototype[e+"Form"]=s(!0)});let Ja=class Es{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(l){s=l});const r=this;this.promise.then(a=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](a);r._listeners=null}),this.promise.then=a=>{let l;const d=new Promise(h=>{r.subscribe(h),l=h}).then(a);return d.cancel=function(){r.unsubscribe(l)},d},e(function(l,d,h){r.reason||(r.reason=new Ye(l,d,h),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=r=>{e.abort(r)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new Es(function(a){e=a}),cancel:e}}};function Qa(n){return function(s){return n.apply(null,s)}}function Ka(n){return x.isObject(n)&&n.isAxiosError===!0}const Vt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Vt).forEach(([n,e])=>{Vt[e]=n});function Rs(n){const e=new Ie(n),s=rs(Ie.prototype.request,e);return x.extend(s,Ie.prototype,e,{allOwnKeys:!0}),x.extend(s,e,null,{allOwnKeys:!0}),s.create=function(a){return Rs(Fe(n,a))},s}const ie=Rs(et);ie.Axios=Ie;ie.CanceledError=Ye;ie.CancelToken=Ja;ie.isCancel=bs;ie.VERSION=_s;ie.toFormData=Mt;ie.AxiosError=Y;ie.Cancel=ie.CanceledError;ie.all=function(e){return Promise.all(e)};ie.spread=Qa;ie.isAxiosError=Ka;ie.mergeConfig=Fe;ie.AxiosHeaders=pe;ie.formToJSON=n=>ys(x.isHTMLForm(n)?new FormData(n):n);ie.getAdapter=Ss.getAdapter;ie.HttpStatusCode=Vt;ie.default=ie;const{Axios:Ti,AxiosError:Ni,CanceledError:Ii,isCancel:Fi,CancelToken:Li,VERSION:$i,all:Bi,Cancel:Ui,isAxiosError:zi,spread:Wi,toFormData:Hi,AxiosHeaders:Yi,HttpStatusCode:qi,formToJSON:Vi,getAdapter:Ji,mergeConfig:Qi}=ie,Ga="/api",Xa=Ga,B=ie.create({baseURL:Xa});B.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers=fe(ne({},n.headers),{Authorization:`Bearer ${e}`})),n});B.interceptors.response.use(n=>n,n=>{var s;return((s=n==null?void 0:n.response)==null?void 0:s.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name"),localStorage.removeItem("userId"),typeof window!="undefined"&&window.location.pathname!=="/"&&window.location.assign("/")),Promise.reject(n)});const As=w.createContext(void 0),Za=({children:n})=>{const[e,s]=w.useState({token:null,role:null,name:null,userId:null,mustChangePassword:!1,ready:!1});w.useEffect(()=>{q(void 0,null,function*(){const h=localStorage.getItem("token"),c=localStorage.getItem("role"),o=localStorage.getItem("name"),i=localStorage.getItem("userId");if(h)try{const u=yield B.get("/auth/me",{headers:{Authorization:`Bearer ${h}`}}),p=u.data.role;localStorage.setItem("role",p),localStorage.setItem("name",u.data.full_name),localStorage.setItem("userId",u.data.id),s({token:h,role:p,name:u.data.full_name,userId:u.data.id,mustChangePassword:!!u.data.must_change_password,ready:!0});return}catch(u){localStorage.clear(),s({token:null,role:null,name:null,userId:null,mustChangePassword:!1,ready:!0});return}(c||o||i)&&localStorage.clear(),s({token:null,role:null,name:null,userId:null,mustChangePassword:!1,ready:!0})})},[]);const r=()=>q(void 0,null,function*(){const d=localStorage.getItem("token");if(!d)return;const h=yield B.get("/auth/me",{headers:{Authorization:`Bearer ${d}`}}),c=h.data.role;localStorage.setItem("role",c),localStorage.setItem("name",h.data.full_name),localStorage.setItem("userId",h.data.id),s({token:d,role:c,name:h.data.full_name,userId:h.data.id,mustChangePassword:!!h.data.must_change_password,ready:!0})}),a=(d,h,c,o)=>q(void 0,null,function*(){const i=yield B.post("/auth/token",{email:d,password:h,mfa_code:c,recovery_code:o}),u=i.data.access_token;localStorage.setItem("token",u);const p=yield B.get("/auth/me",{headers:{Authorization:`Bearer ${u}`}}),y=p.data.role;return localStorage.setItem("role",y),localStorage.setItem("name",p.data.full_name),localStorage.setItem("userId",p.data.id),s({token:u,role:y,name:p.data.full_name,userId:p.data.id,mustChangePassword:!!p.data.must_change_password,ready:!0}),i.data}),l=()=>{localStorage.clear(),s({token:null,role:null,name:null,userId:null,mustChangePassword:!1,ready:!0})};return t.jsx(As.Provider,{value:fe(ne({},e),{login:a,logout:l,refreshMe:r}),children:n})},tt=()=>{const n=w.useContext(As);if(!n)throw new Error("useAuth must be used within AuthProvider");return n},ei={new:"default",acknowledged:"primary",in_investigation:"warning",response_drafted:"secondary",final_response_issued:"success",closed:"success",reopened:"default"},ti=n=>n.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),St=({status:n})=>{const e=typeof n=="string"?n.toLowerCase():n;return t.jsx(xe,{size:"small",label:ti(e),color:ei[e]||"default"})};function ni(){const n=Et(),e=Xt(),{userId:s}=tt(),[r,a]=w.useState(null),[l,d]=w.useState([]),[h,c]=w.useState("mine"),[o,i]=w.useState(!1),[u,p]=w.useState(!1);w.useEffect(()=>{B.get("/complaints/metrics",{params:{_:Date.now()}}).then(f=>a(f.data)).catch(f=>{var b;((b=f==null?void 0:f.response)==null?void 0:b.status)!==401&&console.error("Failed to load dashboard metrics",f)})},[e.key]),w.useEffect(()=>{if(!s)return;q(this,null,function*(){var b;p(!0);try{if(h==="mine"){const S=((yield B.get("/complaints",{params:{handler_id:s,page:1,page_size:50,_:Date.now()}})).data||[]).filter(O=>O.status!=="closed");d(Ut(S));return}if(h==="unassigned"){const S=((yield B.get("/complaints",{params:{page:1,page_size:100,_:Date.now()}})).data||[]).filter(O=>O.status!=="closed").filter(O=>!O.assigned_handler_id);d(Ut(S));return}if(h==="breached"){const S=((yield B.get("/complaints",{params:{overdue:!0,page:1,page_size:100,_:Date.now()}})).data||[]).filter(O=>O.status!=="closed");d(Ut(S));return}if(h==="oldest"){const S=((yield B.get("/complaints",{params:{page:1,page_size:100,_:Date.now()}})).data||[]).filter(O=>O.status!=="closed");S.sort((O,C)=>se(O.received_at).valueOf()-se(C.received_at).valueOf()),d(S.slice(0,20));return}}catch(g){if(((b=g==null?void 0:g.response)==null?void 0:b.status)===401)return;console.error("Failed to load dashboard queue",g)}finally{p(!1)}})},[h,s,e.key]);const y=w.useMemo(()=>r!=null&&r.as_of?se(r.as_of).format("DD MMM YYYY HH:mm"):null,[r==null?void 0:r.as_of]);return t.jsxs(Z,{children:[t.jsxs(H,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:1},children:[t.jsx(j,{variant:"h5",children:"Dashboard"}),y&&t.jsxs(j,{variant:"caption",color:"text.secondary",children:["As of ",y]})]}),t.jsxs(A,{container:!0,spacing:2,sx:{mb:3},children:[t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(dt,{title:"Open now",value:r==null?void 0:r.kpis.open,subtitle:"All open complaints",onClick:()=>c("oldest")})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(dt,{title:"My open",value:r==null?void 0:r.kpis.my_open,subtitle:"Assigned to you",onClick:()=>c("mine")})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(dt,{title:"SLA breached (open)",value:r==null?void 0:r.kpis.open_sla_breaches,subtitle:"Ack or Final breached",onClick:()=>c("breached")})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(dt,{title:"Stale (21d+)",value:r==null?void 0:r.kpis.open_stale_21d,subtitle:"No activity 21+ days",onClick:()=>c("oldest")})})]}),r&&t.jsxs(t.Fragment,{children:[t.jsx(ut,{title:"SLA & Aging",children:t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(re,{sx:{height:"100%"},children:t.jsxs(ae,{children:[t.jsx(j,{variant:"subtitle2",children:"SLA performance (30d)"}),t.jsxs(H,{spacing:1.5,sx:{mt:1},children:[t.jsx(qn,{label:"Ack",item:r.sla_30d.ack}),t.jsx(qn,{label:"Final",item:r.sla_30d.final})]})]})})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(re,{sx:{height:"100%"},children:t.jsxs(ae,{children:[t.jsx(j,{variant:"subtitle2",children:"Aging (open)"}),t.jsxs(H,{spacing:1.2,sx:{mt:1},children:[t.jsx(ht,{label:"07 days",value:r.aging_open["0-7"],total:r.kpis.open}),t.jsx(ht,{label:"821 days",value:r.aging_open["8-21"],total:r.kpis.open}),t.jsx(ht,{label:"2256 days",value:r.aging_open["22-56"],total:r.kpis.open}),t.jsx(ht,{label:"56+ days",value:r.aging_open["56+"],total:r.kpis.open})]})]})})})]})}),t.jsx(ut,{title:"Workload",children:t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(re,{sx:{height:"100%"},children:t.jsxs(ae,{children:[t.jsx(j,{variant:"subtitle2",children:"Open by handler"}),t.jsx(H,{spacing:.75,sx:{mt:1},children:r.workload_open_by_handler.slice(0,6).map(f=>t.jsxs(H,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[t.jsx(j,{variant:"body2",children:f.name}),t.jsx(j,{variant:"body2",fontWeight:700,children:f.count})]},f.id))})]})})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(re,{sx:{height:"100%"},children:t.jsxs(ae,{children:[t.jsx(j,{variant:"subtitle2",children:"Flow (last 7d)"}),t.jsxs(H,{direction:"row",spacing:2,sx:{mt:1},children:[t.jsx(Vn,{label:"New",value:r.flow_7d.new}),t.jsx(Vn,{label:"Closed",value:r.flow_7d.closed})]}),t.jsx(j,{variant:"subtitle2",sx:{mt:2},children:"Open status"}),t.jsx(H,{spacing:.6,sx:{mt:1},children:Object.entries(r.status_open).sort((f,b)=>b[1]-f[1]).slice(0,6).map(([f,b])=>t.jsxs(H,{direction:"row",justifyContent:"space-between",children:[t.jsx(j,{variant:"body2",children:f.replace(/_/g," ")}),t.jsx(j,{variant:"body2",fontWeight:700,children:b})]},f))})]})})})]})}),t.jsx(ut,{title:"Risk & Compliance",children:t.jsx(re,{children:t.jsxs(ae,{children:[t.jsxs(A,{container:!0,spacing:2,children:[t.jsxs(A,{item:!0,xs:12,md:3,children:[t.jsx(j,{variant:"subtitle2",children:"Vulnerable (open)"}),t.jsx(j,{variant:"h5",children:r.risk.open_vulnerable.count}),t.jsx(j,{variant:"caption",color:"text.secondary",children:gt(r.risk.open_vulnerable.pct_of_open)})]}),t.jsxs(A,{item:!0,xs:12,md:3,children:[t.jsx(j,{variant:"subtitle2",children:"Escalated (open)"}),t.jsx(j,{variant:"h5",children:r.risk.escalated_open}),t.jsx(j,{variant:"caption",color:"text.secondary",children:"Current open escalations"})]}),t.jsxs(A,{item:!0,xs:12,md:3,children:[t.jsx(j,{variant:"subtitle2",children:"Reopened (all time)"}),t.jsx(j,{variant:"h5",children:r.risk.reopened.count}),t.jsx(j,{variant:"caption",color:"text.secondary",children:gt(r.risk.reopened.pct_all_time)})]}),t.jsxs(A,{item:!0,xs:12,md:3,children:[t.jsx(j,{variant:"subtitle2",children:"Final attachments (open)"}),t.jsx(j,{variant:"h5",children:gt(r.risk.final_attachment_open_pct)}),t.jsx(j,{variant:"caption",color:"text.secondary",children:"Coverage on open cases"})]})]}),t.jsxs(tr,{in:o,unmountOnExit:!0,children:[t.jsx(ts,{sx:{my:2}}),t.jsx(j,{variant:"subtitle2",children:"Notes"}),t.jsx(j,{variant:"body2",color:"text.secondary",children:"Stale means no communications in 21+ days (or received date if no comms)."})]}),t.jsx(U,{size:"small",onClick:()=>i(f=>!f),sx:{mt:1},children:o?"Hide details":"View details"})]})})}),t.jsx(ut,{title:"My Queue",children:t.jsxs(re,{children:[t.jsx(ae,{sx:{pb:1},children:t.jsxs(ns,{value:h,onChange:(f,b)=>c(b),variant:"scrollable",scrollButtons:"auto",children:[t.jsx(Re,{value:"mine",label:"Assigned to me"}),t.jsx(Re,{value:"unassigned",label:"Unassigned"}),t.jsx(Re,{value:"breached",label:"SLA breached"}),t.jsx(Re,{value:"oldest",label:"Oldest open"})]})}),u&&t.jsx(Jt,{}),t.jsxs(ft,{dense:!0,children:[!u&&l.length===0&&t.jsx(De,{children:t.jsx(Te,{primary:"No items"})}),l.map(f=>{var b,g;return t.jsxs(De,{button:!0,onClick:()=>n(`/complaints/${f.id}`),children:[t.jsx(Te,{primary:`${f.reference} - ${(g=(b=f.complainant)==null?void 0:b.full_name)!=null?g:"Unknown"}`,secondary:si(f)}),t.jsxs(H,{direction:"row",spacing:1,alignItems:"center",children:[f.ack_breached||f.final_breached?t.jsx(xe,{size:"small",label:"Breach"}):null,t.jsx(St,{status:f.status})]})]},f.id)})]})]})})]})]})}function dt({title:n,value:e,subtitle:s,onClick:r}){const a=t.jsxs(ae,{children:[t.jsx(j,{variant:"subtitle2",children:n}),t.jsx(j,{variant:"h4",children:e!=null?e:""}),s&&t.jsx(j,{variant:"caption",color:"text.secondary",children:s})]});return t.jsx(re,{sx:{height:"100%"},children:r?t.jsx(nr,{onClick:r,sx:{height:"100%"},children:a}):a})}function ut({title:n,children:e}){return t.jsxs(Z,{sx:{mb:3},children:[t.jsxs(H,{direction:"row",alignItems:"center",spacing:1,sx:{mb:1},children:[t.jsx(j,{variant:"subtitle1",children:n}),t.jsx(ts,{sx:{flexGrow:1}})]}),e]})}function qn({label:n,item:e}){const s=e.on_time_pct;return t.jsxs(Z,{children:[t.jsxs(H,{direction:"row",justifyContent:"space-between",children:[t.jsx(j,{variant:"body2",fontWeight:700,children:n}),t.jsx(j,{variant:"body2",color:"text.secondary",children:e.total>0?`${e.on_time}/${e.total}`:""})]}),t.jsx(H,{direction:"row",justifyContent:"space-between",sx:{mt:.3},children:t.jsx(j,{variant:"body1",children:gt(s)})}),t.jsx(Jt,{variant:"determinate",value:s!=null?s:0,sx:{mt:.6}})]})}function ht({label:n,value:e,total:s}){const r=s>0?e/s*100:0;return t.jsxs(Z,{children:[t.jsxs(H,{direction:"row",justifyContent:"space-between",children:[t.jsx(j,{variant:"body2",children:n}),t.jsx(j,{variant:"body2",fontWeight:700,children:e})]}),t.jsx(Jt,{variant:"determinate",value:r,sx:{mt:.5}})]})}function Vn({label:n,value:e}){return t.jsxs(Z,{children:[t.jsx(j,{variant:"subtitle2",children:n}),t.jsx(j,{variant:"h5",children:e})]})}function gt(n){return n!=null?`${n.toFixed(0)}%`:""}function si(n){const e=n.received_at?se(n.received_at).format("DD MMM YYYY"):"";return[n.product?n.product:"",`Received ${e}`].filter(Boolean).join("  ")}function Ut(n){return[...n].sort((e,s)=>{const r=e.ack_breached||e.final_breached?1:0,a=s.ack_breached||s.final_breached?1:0;return r!==a?a-r:se(e.received_at).valueOf()-se(s.received_at).valueOf()})}const ri=["New","Acknowledged","In Investigation","Response Drafted","Final Response Issued","Closed","Reopened"];function ai(){const[n,e]=w.useState([]),[s,r]=w.useState([]),[a,l]=w.useState(""),[d,h]=w.useState(""),c=Et(),o=()=>{B.get("/complaints",{params:{status_filter:a||void 0,search:d||void 0}}).then(i=>e(i.data))};return w.useEffect(()=>{o(),B.get("/users").then(i=>r(i.data))},[]),t.jsxs(Z,{children:[t.jsx(j,{variant:"h5",gutterBottom:!0,children:"Complaints"}),t.jsx(re,{sx:{mb:2},children:t.jsx(ae,{children:t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(z,{select:!0,label:"Status",fullWidth:!0,size:"small",value:a,onChange:i=>l(i.target.value),children:[t.jsx(G,{value:"",children:"All"}),ri.map(i=>t.jsx(G,{value:i,children:i},i))]})}),t.jsx(A,{item:!0,xs:12,md:5,children:t.jsx(z,{label:"Search ref / policy / name",fullWidth:!0,size:"small",value:d,onChange:i=>h(i.target.value)})}),t.jsxs(A,{item:!0,xs:12,md:4,display:"flex",alignItems:"center",gap:1,children:[t.jsx(U,{variant:"contained",onClick:o,children:"Apply"}),t.jsx(U,{component:Ee,to:"/complaints/new",children:"New complaint"})]})]})})}),t.jsx(re,{children:t.jsxs(Qt,{size:"small",children:[t.jsx(Kt,{children:t.jsxs(Se,{children:[t.jsx(Q,{children:"Reference"}),t.jsx(Q,{children:"Complainant"}),t.jsx(Q,{children:"Product"}),t.jsx(Q,{children:"Handler"}),t.jsx(Q,{children:"Received"}),t.jsx(Q,{children:"Status"}),t.jsx(Q,{children:"Due (Final)"})]})}),t.jsx(Gt,{children:n.map(i=>{var u;return t.jsxs(Se,{hover:!0,sx:{cursor:"pointer"},onClick:()=>c(`/complaints/${i.id}`),children:[t.jsx(Q,{children:i.reference}),t.jsx(Q,{children:(u=i.complainant)==null?void 0:u.full_name}),t.jsx(Q,{children:i.product}),t.jsx(Q,{children:i.assigned_handler_name||"Unassigned"}),t.jsx(Q,{children:se(i.received_at).format("DD MMM YYYY")}),t.jsx(Q,{children:t.jsx(St,{status:i.status})}),t.jsx(Q,{children:se(i.final_due_at).format("DD MMM YYYY")})]},i.id)})})]})})]})}const Jn=[{value:"financial_loss",label:"Financial Loss (Direct Loss)"},{value:"interest_on_financial_loss",label:"Interest on Financial Loss"},{value:"distress_and_inconvenience",label:"Distress and Inconvenience"},{value:"consequential_loss",label:"Consequential Loss"},{value:"premium_refund_adjustment",label:"Premium Refund / Adjustment"},{value:"goodwill_payment",label:"Goodwill Payment"},{value:"third_party_payment",label:"Third-Party Payment"},{value:"apology_or_explanation",label:"Apology / Explanation (Non-monetary)"},{value:"remedial_action",label:"Remedial Action (Non-monetary)"}],Qn=["financial_loss","interest_on_financial_loss","distress_and_inconvenience","consequential_loss","premium_refund_adjustment","goodwill_payment","third_party_payment"],ii="/api",oi=ii.replace(/\/api$/,"");function li(){var bn,jn;const{id:n}=yr(),[e,s]=w.useState(null),[r,a]=w.useState(0),{role:l,name:d,userId:h}=tt(),[c,o]=w.useState("email"),[i,u]=w.useState("outbound"),[p,y]=w.useState(""),[f,b]=w.useState(se().format("YYYY-MM-DDTHH:mm")),[g,S]=w.useState(null),[O,C]=w.useState(!1),[k,N]=w.useState(!1),[J,te]=w.useState("upheld"),[de,P]=w.useState(""),[I,E]=w.useState(!1),[V,ee]=w.useState(""),[T,R]=w.useState("goodwill_payment"),[v,D]=w.useState("pending"),[_,$]=w.useState(""),[L,M]=w.useState(""),[W,F]=w.useState(""),[K,oe]=w.useState("not_started"),[ve,be]=w.useState(!1),[_e,je]=w.useState(!1),[le,ge]=w.useState(null),[Ae,Oe]=w.useState(!1),[sn,rn]=w.useState(""),[kt,an]=w.useState(se().format("YYYY-MM-DD")),[on,ln]=w.useState(!1),[$e,ks]=w.useState([]),[nt,Dt]=w.useState(""),[qe,st]=w.useState(!1),[Ds,rt]=w.useState(!1),[at,cn]=w.useState(""),[it,dn]=w.useState(!1),[un,hn]=w.useState(!1),[Ts,Ve]=w.useState(!1),[ot,Ns]=w.useState("standard"),[Je,Is]=w.useState(se().format("YYYY-MM-DD")),[Tt,Nt]=w.useState(""),[fn,lt]=w.useState(null),Ce=Qn.includes(T),Fs=m=>{var X;return((X=Jn.find(ue=>ue.value===m))==null?void 0:X.label)||m},[mn,Ls]=w.useState([]),pn=(m,X)=>q(this,null,function*(){e&&(yield B.patch(`/complaints/${e.id}/redress/${m}`,X),he())}),xn=(bn=e==null?void 0:e.communications)!=null&&bn.length?e.communications.map(m=>m.occurred_at).sort().slice(-1)[0]:null,he=()=>{B.get(`/complaints/${n}`).then(m=>s(m.data)),B.get(`/complaints/${n}/events`).then(m=>Ls(m.data))};w.useEffect(()=>{he()},[n]),w.useEffect(()=>{l&&l!=="read_only"&&B.get("/users").then(m=>ks(m.data))},[l]);const gn=m=>q(this,null,function*(){yield B.post(`/complaints/${n}/${m}`),he()}),$s=()=>q(this,null,function*(){if(e){E(!0);try{yield B.post(`/complaints/${e.id}/outcome`,{outcome:J,notes:de||null}),he()}finally{E(!1)}}}),Bs=()=>q(this,null,function*(){var X,ue;if(!e)return;const m=Ce;if(!(m&&V==="")&&!(m&&!L.trim())&&!(!m&&!W.trim())){je(!0);try{yield B.post(`/complaints/${e.id}/redress`,{amount:m?Number(V):null,payment_type:T,status:m?v:"pending",notes:_||null,outcome_id:(ue=(X=e.outcome)==null?void 0:X.id)!=null?ue:null,rationale:L||null,action_description:W||null,action_status:K,approved:m?ve:!1}),ee(""),$(""),R("goodwill_payment"),D("pending"),M(""),F(""),oe("not_started"),be(!1),he()}finally{je(!1)}}}),Us=()=>q(this,null,function*(){if(!e||!p||k&&!e.outcome)return;C(!0);const m=new FormData;m.append("channel",c),m.append("direction",i),m.append("summary",p),m.append("occurred_at",new Date(f).toISOString()),m.append("is_final_response",String(k)),g&&Array.from(g).forEach(X=>m.append("files",X));try{yield B.post(`/complaints/${e.id}/communications`,m,{headers:{"Content-Type":"multipart/form-data"}}),y(""),S(null),b(se().format("YYYY-MM-DDTHH:mm")),N(!1),he()}finally{C(!1)}}),zs=()=>q(this,null,function*(){if(e){ln(!0);try{yield B.post(`/complaints/${e.id}/reopen`,{reason:sn||null,reopened_at:kt?new Date(kt).toISOString():null}),Oe(!1),rn(""),an(se().format("YYYY-MM-DD")),he()}finally{ln(!1)}}}),Ws=()=>{var ue;const m=$e.filter(Me=>Me.role==="complaints_manager"),X=(e!=null&&e.assigned_handler_id&&m.some(Me=>Me.id===e.assigned_handler_id)?e.assigned_handler_id:(ue=m[0])==null?void 0:ue.id)||"";cn(X),rt(!0)},Hs=()=>q(this,null,function*(){if(!(!e||!at)){st(!0);try{yield B.post(`/complaints/${e.id}/escalate`,{manager_id:at}),rt(!1),he()}finally{st(!1)}}}),Ys=()=>q(this,null,function*(){if(e){st(!0);try{yield B.patch(`/complaints/${e.id}`,{is_escalated:!1}),he()}finally{st(!1)}}}),qs=()=>q(this,null,function*(){nt&&(yield B.post(`/complaints/${n}/assign`,null,{params:{handler_id:nt}}),Dt(""),he())}),Vs=()=>q(this,null,function*(){var m,X;dn(!0),lt(null);try{yield B.post(`/complaints/${n}/close-non-reportable`,{closed_at:Je?new Date(Je).toISOString():null,comment:Tt||null}),Ve(!1),Nt(""),he()}catch(ue){const Me=(X=(m=ue==null?void 0:ue.response)==null?void 0:m.data)==null?void 0:X.detail;lt(Me||"Could not close as non-reportable")}finally{dn(!1)}}),Js=()=>q(this,null,function*(){var m,X;hn(!0),lt(null);try{yield B.post(`/complaints/${n}/close`,{closed_at:Je?new Date(Je).toISOString():null,comment:Tt||null}),Ve(!1),Nt(""),he()}catch(ue){const Me=(X=(m=ue==null?void 0:ue.response)==null?void 0:m.data)==null?void 0:X.detail;lt(Me||"Could not close complaint")}finally{hn(!1)}}),yn=m=>{Ns(m),Ve(!0)};return e?t.jsxs(Z,{children:[t.jsxs(H,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[t.jsxs("div",{children:[t.jsx(j,{variant:"h5",children:e.reference}),t.jsx(j,{variant:"subtitle1",children:e.complainant.full_name})]}),t.jsx(St,{status:e.status})]}),t.jsxs(A,{container:!0,spacing:2,mb:2,children:[t.jsx(A,{item:!0,children:t.jsx(xe,{label:`Product: ${e.product||"n/a"}`})}),t.jsx(A,{item:!0,children:t.jsx(xe,{label:`Policy: ${e.policy_number||"n/a"}`})}),e.vulnerability_flag&&t.jsx(A,{item:!0,children:t.jsx(xe,{color:"warning",label:"Vulnerable"})})]}),t.jsxs(H,{direction:"row",spacing:1,mb:2,children:[t.jsx(U,{variant:"contained",size:"small",disabled:l==="read_only",onClick:()=>gn("acknowledge"),children:"Acknowledge"}),t.jsx(U,{variant:"outlined",size:"small",disabled:l==="read_only",onClick:()=>gn("investigate"),children:"Move to investigation"}),t.jsx(U,{variant:"outlined",size:"small",disabled:l==="read_only",onClick:()=>yn("standard"),children:"Close"}),t.jsx(U,{variant:"outlined",size:"small",color:"warning",disabled:l==="read_only"||it,onClick:()=>yn("non_reportable"),children:it?"Closing...":"Close as non-reportable"}),(e==null?void 0:e.status)==="closed"&&t.jsx(U,{variant:"outlined",size:"small",disabled:l==="read_only",onClick:()=>Oe(m=>!m),children:"Reopen"}),t.jsx(U,{variant:"outlined",size:"small",color:"secondary",disabled:l==="read_only"||qe||$e.filter(m=>m.role==="complaints_manager").length===0,onClick:Ws,children:e.is_escalated?"Change escalation":"Escalate"}),e.is_escalated&&t.jsx(U,{variant:"text",size:"small",color:"inherit",onClick:Ys,disabled:l==="read_only"||qe,children:"Remove escalation"}),l==="admin"&&t.jsxs(H,{direction:"row",spacing:1,alignItems:"center",sx:{ml:{xs:0,md:2}},children:[t.jsxs(z,{select:!0,size:"small",label:"Assign handler",value:nt||e.assigned_handler_id||"",onChange:m=>Dt(m.target.value),sx:{minWidth:200},children:[t.jsx(G,{value:"",children:"(Unassigned)"}),$e.map(m=>t.jsx(G,{value:m.id,children:m.full_name},m.id))]}),t.jsx(U,{variant:"contained",size:"small",onClick:qs,disabled:!nt,children:"Assign"}),t.jsx(U,{variant:"outlined",size:"small",onClick:()=>{const m=$e.find(X=>X.full_name===d);m&&(Dt(m.id),B.post(`/complaints/${n}/assign`,null,{params:{handler_id:m.id}}).then(he))},disabled:!$e.length,children:"Assign to me"})]}),l==="complaints_handler"&&!e.assigned_handler_id&&h&&t.jsx(U,{variant:"outlined",size:"small",onClick:()=>B.post(`/complaints/${n}/assign`,null,{params:{handler_id:h}}).then(he),children:"Assign to me"})]}),Ae&&(e==null?void 0:e.status)==="closed"&&t.jsx(re,{sx:{mb:2},children:t.jsxs(ae,{children:[t.jsx(j,{variant:"subtitle2",children:"Reopen complaint"}),t.jsx(j,{variant:"caption",color:"text.secondary",children:"Leave the date blank to use today's date."}),t.jsxs(A,{container:!0,spacing:2,mt:1,children:[t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{fullWidth:!0,label:"Reason for reopen",multiline:!0,minRows:3,value:sn,onChange:m=>rn(m.target.value)})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(z,{fullWidth:!0,label:"Reopen date",type:"date",value:kt,onChange:m=>an(m.target.value),helperText:"Blank = today"})}),t.jsx(A,{item:!0,xs:12,md:3,display:"flex",alignItems:"center",children:t.jsx(U,{variant:"contained",onClick:zs,disabled:on,children:on?"Reopening...":"Confirm reopen"})})]})]})}),t.jsxs(ns,{value:r,onChange:(m,X)=>a(X),sx:{mb:2},children:[t.jsx(Re,{label:"Overview"}),t.jsx(Re,{label:"Communications"}),t.jsx(Re,{label:"Outcome / Redress"}),t.jsx(Re,{label:"History"})]}),r===0&&t.jsx(re,{children:t.jsx(ae,{sx:{p:3},children:t.jsxs(H,{spacing:3,children:[t.jsxs(H,{direction:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",rowGap:1,children:[t.jsxs(Z,{children:[t.jsx(j,{variant:"overline",color:"text.secondary",sx:{letterSpacing:.6},children:"Overview"}),t.jsxs(j,{variant:"h6",sx:{fontWeight:700,mt:.5},children:[e.reference,"  ",e.complainant.full_name]}),t.jsxs(j,{variant:"body2",color:"text.secondary",children:["Received ",se(e.received_at).format("DD MMM YYYY"),"  Source ",e.source||"n/a"]})]}),t.jsxs(H,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(St,{status:e.status}),e.vulnerability_flag&&t.jsx(xe,{size:"small",color:"warning",label:"Vulnerable"}),e.is_escalated&&t.jsx(xe,{size:"small",color:"error",label:"Escalated"}),e.ack_breached&&t.jsx(xe,{size:"small",color:"error",label:"Ack SLA breached"}),e.final_breached&&t.jsx(xe,{size:"small",color:"error",label:"Final SLA breached"})]})]}),t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:8,children:t.jsx(Z,{sx:{p:2,borderRadius:2,background:"#f8fafc",border:"1px solid #e5e7eb",minHeight:140},children:t.jsx(j,{variant:"body1",sx:{lineHeight:1.6},children:e.description})})}),t.jsx(A,{item:!0,xs:12,md:4,children:t.jsx(Z,{sx:{p:2,borderRadius:2,background:"#0f4c81",color:"#f8fafc",height:"100%"},children:t.jsxs(H,{spacing:1,children:[t.jsxs(j,{variant:"body1",children:["Ack due: ",se(e.ack_due_at).format("DD MMM YYYY")]}),t.jsxs(j,{variant:"body1",children:["Final due: ",se(e.final_due_at).format("DD MMM YYYY")]}),t.jsxs(j,{variant:"body2",sx:{mt:1,color:"rgba(255,255,255,0.8)"},children:["Last updated: ",xn?se(xn).format("DD MMM YYYY HH:mm"):"No communications"]})]})})})]}),t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(Z,{sx:{p:2,border:"1px solid #e5e7eb",borderRadius:2},children:[t.jsx(j,{variant:"caption",color:"text.secondary",children:"Product"}),t.jsx(j,{variant:"body1",children:e.product||"n/a"})]})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(Z,{sx:{p:2,border:"1px solid #e5e7eb",borderRadius:2},children:[t.jsx(j,{variant:"caption",color:"text.secondary",children:"Policy"}),t.jsx(j,{variant:"body1",children:e.policy_number||"n/a"})]})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(Z,{sx:{p:2,border:"1px solid #e5e7eb",borderRadius:2},children:[t.jsx(j,{variant:"caption",color:"text.secondary",children:"Broker / Insurer"}),t.jsx(j,{variant:"body1",children:e.broker||"n/a"}),t.jsx(j,{variant:"body2",color:"text.secondary",children:e.insurer||""})]})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(Z,{sx:{p:2,border:"1px solid #e5e7eb",borderRadius:2},children:[t.jsx(j,{variant:"caption",color:"text.secondary",children:"Category / Reason"}),t.jsxs(j,{variant:"body1",children:[e.category||"n/a",e.reason?`  ${e.reason}`:""]})]})})]})]})})}),r===1&&t.jsxs(H,{spacing:2.5,children:[t.jsx(re,{children:t.jsxs(ae,{sx:{p:3},children:[t.jsx(j,{variant:"subtitle2",gutterBottom:!0,children:"Add communication"}),t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(z,{select:!0,fullWidth:!0,label:"Channel",value:c,onChange:m=>o(m.target.value),children:[{value:"phone",label:"Phone call"},{value:"email",label:"Email"},{value:"letter",label:"Letter"},{value:"web",label:"Web"},{value:"third_party",label:"Third party"},{value:"other",label:"Other"}].map(m=>t.jsx(G,{value:m.value,children:m.label},m.value))})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(z,{select:!0,fullWidth:!0,label:"Direction",value:i,onChange:m=>u(m.target.value),children:[t.jsx(G,{value:"outbound",children:"Outbound"}),t.jsx(G,{value:"inbound",children:"Inbound"})]})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{fullWidth:!0,label:"When",type:"datetime-local",value:f,onChange:m=>b(m.target.value)})}),t.jsx(A,{item:!0,xs:12,children:t.jsx(z,{fullWidth:!0,multiline:!0,minRows:3,label:"Summary",value:p,onChange:m=>y(m.target.value)})}),t.jsxs(A,{item:!0,xs:12,md:6,display:"flex",alignItems:"center",children:[t.jsx(yt,{control:t.jsx(Sn,{checked:k,onChange:m=>N(m.target.checked),disabled:!e.outcome}),label:"This is the final response"}),!e.outcome&&t.jsx(j,{variant:"caption",color:"text.secondary",sx:{ml:1},children:"Record an outcome first."})]}),t.jsxs(A,{item:!0,xs:12,md:6,display:"flex",alignItems:"center",justifyContent:"flex-end",children:[t.jsxs(U,{variant:"outlined",component:"label",size:"small",children:["Attach files",t.jsx("input",{hidden:!0,multiple:!0,type:"file",onChange:m=>S(m.target.files)})]}),g&&g.length>0&&t.jsxs(j,{variant:"caption",sx:{ml:1},children:[g.length," file(s) selected"]})]}),t.jsx(A,{item:!0,xs:12,children:t.jsx(U,{variant:"contained",onClick:Us,disabled:O||!p||k&&!e.outcome,children:O?"Saving...":"Add communication"})})]})]})}),t.jsx(re,{children:t.jsx(ae,{sx:{p:0},children:t.jsxs(ft,{dense:!0,children:[(jn=e.communications)==null?void 0:jn.map(m=>t.jsxs(De,{alignItems:"flex-start",sx:{borderBottom:"1px solid #e5e7eb",py:1.5,px:2},children:[t.jsx(Te,{primaryTypographyProps:{sx:{fontWeight:600}},primary:`${m.direction} ${m.channel}`,secondary:t.jsxs(H,{spacing:.5,sx:{mt:.5},children:[t.jsx(j,{variant:"body2",color:"text.primary",children:m.summary}),t.jsx(j,{variant:"caption",color:"text.secondary",children:se(m.occurred_at).format("DD MMM YYYY HH:mm")})]})}),t.jsxs(H,{direction:"row",spacing:1,alignItems:"center",children:[m.is_final_response&&t.jsx(xe,{size:"small",color:"success",label:"Final response"}),m.attachments&&m.attachments.length>0&&t.jsx(H,{direction:"row",spacing:1,children:m.attachments.map(X=>t.jsx(U,{size:"small",component:"a",href:`${oi}${X.url}`,target:"_blank",rel:"noreferrer",children:X.file_name},X.id))})]})]},m.id)),(!e.communications||e.communications.length===0)&&t.jsx(De,{sx:{py:2,px:2},children:t.jsx(Te,{primary:"No communications recorded"})})]})})})]}),r===2&&t.jsxs(H,{spacing:2.5,children:[t.jsx(re,{children:t.jsxs(ae,{sx:{p:3},children:[t.jsx(j,{variant:"subtitle2",gutterBottom:!0,children:"Outcome"}),t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:4,children:t.jsx(z,{select:!0,fullWidth:!0,label:"Outcome",value:J,onChange:m=>te(m.target.value),children:[["upheld","Upheld"],["partially_upheld","Partially upheld"],["not_upheld","Not upheld"],["withdrawn","Withdrawn"],["out_of_scope","Out of scope"]].map(([m,X])=>t.jsx(G,{value:m,children:X},m))})}),t.jsx(A,{item:!0,xs:12,md:8,children:t.jsx(z,{fullWidth:!0,label:"Outcome notes",multiline:!0,minRows:3,value:de,onChange:m=>P(m.target.value)})}),t.jsxs(A,{item:!0,xs:12,children:[t.jsx(U,{variant:"contained",size:"small",onClick:$s,disabled:I,children:I?"Saving...":"Save outcome"}),e.outcome&&t.jsxs(j,{variant:"body2",sx:{ml:2},component:"span",children:["Current: ",e.outcome.outcome]})]})]})]})}),t.jsx(re,{children:t.jsxs(ae,{sx:{p:3},children:[t.jsx(j,{variant:"subtitle2",gutterBottom:!0,children:"Redress"}),t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(z,{select:!0,fullWidth:!0,label:"Redress type",value:T,onChange:m=>R(m.target.value),children:Jn.map(m=>t.jsx(G,{value:m.value,children:m.label},m.value))})}),Ce&&t.jsx(A,{item:!0,xs:12,md:3,children:t.jsx(z,{type:"number",fullWidth:!0,label:"Amount (monetary)",value:V,onChange:m=>ee(m.target.value===""?"":Number(m.target.value))})}),Ce&&t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{fullWidth:!0,label:"Rationale (monetary)",multiline:!0,minRows:2,value:L,onChange:m=>M(m.target.value),helperText:"Required for monetary redress"})}),!Ce&&t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{fullWidth:!0,label:"Action description (non-monetary)",multiline:!0,minRows:2,value:W,onChange:m=>F(m.target.value),helperText:"Required for non-monetary redress"})}),Ce&&t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(z,{select:!0,fullWidth:!0,label:"Status",value:v,onChange:m=>D(m.target.value),children:[t.jsx(G,{value:"pending",children:"Pending"}),t.jsx(G,{value:"authorised",children:"Authorised"}),t.jsx(G,{value:"paid",children:"Paid"})]})}),t.jsx(A,{item:!0,xs:12,md:3,children:t.jsxs(z,{select:!0,fullWidth:!0,label:"Action status",value:K,onChange:m=>oe(m.target.value),children:[t.jsx(G,{value:"not_started",children:"Not Started"}),t.jsx(G,{value:"in_progress",children:"In Progress"}),t.jsx(G,{value:"completed",children:"Completed"})]})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{fullWidth:!0,label:"Notes",multiline:!0,minRows:3,value:_,onChange:m=>$(m.target.value)})}),Ce&&t.jsx(A,{item:!0,xs:12,md:3,display:"flex",alignItems:"center",children:t.jsx(yt,{control:t.jsx(Sn,{checked:ve,onChange:m=>be(m.target.checked)}),label:"Approved"})}),t.jsx(A,{item:!0,xs:12,children:t.jsx(U,{variant:"contained",size:"small",onClick:Bs,disabled:_e||Ce&&V===""||Ce&&!L.trim()||!Ce&&!W.trim(),children:_e?"Saving...":"Add redress"})})]}),e.redress_payments&&e.redress_payments.length>0?t.jsx(ft,{dense:!0,sx:{mt:2},children:e.redress_payments.map(m=>t.jsxs(De,{alignItems:"flex-start",onClick:()=>ge(m.id),sx:{borderBottom:"1px solid #e5e7eb",py:1.5,px:0,cursor:"pointer"},children:[le===m.id&&t.jsx(j,{variant:"caption",color:"text.secondary",sx:{position:"absolute",top:8,right:0},children:"Tap to select status"}),t.jsx(Te,{primaryTypographyProps:{sx:{fontWeight:600}},secondaryTypographyProps:{component:"div"},primary:`${Fs(m.payment_type)}${m.amount?`  ${m.amount}`:""}`,secondary:t.jsxs(H,{component:"div",spacing:.5,sx:{mt:.5},children:[Qn.includes(m.payment_type)?le===m.id?t.jsxs(_n,{size:"small",sx:{minWidth:160},children:[t.jsx(En,{children:"Status"}),t.jsxs(Rn,{label:"Status",value:m.status,onChange:X=>q(this,null,function*(){yield pn(m.id,{status:X.target.value,approved:m.approved}),ge(null)}),children:[t.jsx(G,{value:"pending",children:"Pending"}),t.jsx(G,{value:"authorised",children:"Authorised"}),t.jsx(G,{value:"paid",children:"Paid"})]})]}):t.jsxs(j,{component:"span",variant:"caption",children:["Status: ",m.status," (click to update)"]}):le===m.id?t.jsxs(_n,{size:"small",sx:{minWidth:180},children:[t.jsx(En,{children:"Action status"}),t.jsxs(Rn,{label:"Action status",value:m.action_status||"not_started",onChange:X=>q(this,null,function*(){yield pn(m.id,{action_status:X.target.value}),ge(null)}),children:[t.jsx(G,{value:"not_started",children:"Not Started"}),t.jsx(G,{value:"in_progress",children:"In Progress"}),t.jsx(G,{value:"completed",children:"Completed"})]})]}):t.jsxs(j,{component:"span",variant:"caption",children:["Action: ",m.action_description||"n/a"," (",m.action_status||"not_started",")  click to update"]}),m.approved&&t.jsx(xe,{size:"small",label:"Approved",color:"success",sx:{maxWidth:"fit-content"}}),m.rationale&&t.jsxs(j,{component:"span",variant:"caption",display:"block",children:["Rationale: ",m.rationale]}),m.action_description&&t.jsxs(j,{component:"span",variant:"caption",display:"block",children:["Action: ",m.action_description," (",m.action_status,")"]}),m.notes&&t.jsxs(j,{component:"span",variant:"caption",display:"block",children:["Notes: ",m.notes]})]})})]},m.id))}):t.jsx(j,{color:"text.secondary",mt:2,children:"No redress recorded"})]})})]}),r===3&&t.jsx(re,{children:t.jsxs(ae,{sx:{p:3},children:[t.jsx(j,{variant:"subtitle2",gutterBottom:!0,children:"History / Audit trail"}),t.jsxs(ft,{dense:!0,children:[mn.length===0&&t.jsx(De,{children:t.jsx(Te,{primary:"No events recorded yet"})}),mn.map(m=>t.jsx(De,{sx:{borderBottom:"1px solid #e5e7eb"},children:t.jsx(Te,{primaryTypographyProps:{sx:{fontWeight:600}},secondaryTypographyProps:{component:"div"},primary:m.event_type.replace(/_/g," "),secondary:t.jsxs(H,{spacing:.5,children:[m.description&&t.jsx(j,{variant:"body2",children:m.description}),(m.created_by_name||m.created_by_id)&&t.jsx(j,{variant:"caption",color:"text.secondary",children:`By ${m.created_by_name||m.created_by_id}`}),t.jsx(j,{variant:"caption",color:"text.secondary",children:se(m.created_at).format("DD MMM YYYY HH:mm")})]})})},m.id))]})]})}),t.jsxs(bt,{open:Ds,onClose:()=>rt(!1),fullWidth:!0,maxWidth:"sm",children:[t.jsx(jt,{children:"Escalate to manager"}),t.jsx(wt,{dividers:!0,children:t.jsxs(H,{spacing:2,sx:{mt:1},children:[t.jsx(z,{select:!0,fullWidth:!0,label:"Manager",value:at,onChange:m=>cn(m.target.value),children:$e.filter(m=>m.role==="complaints_manager").map(m=>t.jsx(G,{value:m.id,children:m.full_name},m.id))}),t.jsx(j,{variant:"body2",color:"text.secondary",children:"Selecting a manager will assign the complaint to them and mark it as escalated."})]})}),t.jsxs(vt,{children:[t.jsx(U,{onClick:()=>rt(!1),disabled:qe,children:"Cancel"}),t.jsx(U,{variant:"contained",onClick:Hs,disabled:qe||!at,children:qe?"Escalating...":"Confirm escalation"})]})]}),t.jsxs(bt,{open:Ts,onClose:()=>Ve(!1),fullWidth:!0,maxWidth:"sm",children:[t.jsx(jt,{children:ot==="non_reportable"?"Close as non-reportable":"Close complaint"}),t.jsx(wt,{dividers:!0,children:t.jsxs(H,{spacing:2,sx:{mt:1},children:[fn&&t.jsx(ze,{severity:"error",children:fn}),t.jsx(z,{fullWidth:!0,label:"Closed date",type:"date",value:Je,onChange:m=>Is(m.target.value),helperText:"Choose the effective closed date"}),t.jsx(z,{fullWidth:!0,label:"Comments (optional)",multiline:!0,minRows:2,value:Tt,onChange:m=>Nt(m.target.value)})]})}),t.jsxs(vt,{children:[t.jsx(U,{onClick:()=>Ve(!1),children:"Cancel"}),t.jsx(U,{variant:"contained",onClick:ot==="non_reportable"?Vs:Js,disabled:ot==="non_reportable"?it:un,children:ot==="non_reportable"?it?"Closing...":"Confirm close (non-reportable)":un?"Closing...":"Confirm close"})]})]})]}):t.jsx(j,{children:"Loading..."})}const Kn=["Complainant","Complaint","Policy"],Gn=["Policy Administration","Sales and Advice","Pricing and Premiums","Claims Handling","Customer Service","Cancellations and Refunds","Disclosure and Documentation","Vulnerability and Customer Treatment","Data Protection and Privacy","Third-Party / Supplier Issues","Fraud or Financial Crime","Other / Unclassified"];function ci(){const[n,e]=w.useState(0),[s,r]=w.useState({source:"Web",received_at:se().toISOString(),description:"",category:Gn[0],reason:"",fca_complaint:!0,vulnerability_flag:!1,complainant:{full_name:""},policy:{}}),[a,l]=w.useState(null),[d,h]=w.useState({products:[],insurers:[],brokers:[]}),c=Et();w.useEffect(()=>{q(this,null,function*(){try{const[p,y,f]=yield Promise.all([B.get("/reference/products"),B.get("/reference/insurers"),B.get("/reference/brokers")]);h({products:p.data,insurers:y.data,brokers:f.data})}catch(p){}})},[]);const o=(u,p)=>{const y=u.split(".");r(f=>{const b=ne({},f);let g=b;return y.forEach((S,O)=>{O===y.length-1?g[S]=p:(g[S]=ne({},g[S]),g=g[S])}),b})},i=()=>q(this,null,function*(){if(s.category==="Other / Unclassified"&&!(s.reason&&s.reason.trim())){alert('Please provide a justification when selecting "Other / Unclassified".');return}const p=(yield B.post("/complaints",s)).data.id;if(a&&["Email","Letter"].includes(s.source)){const y=new FormData;y.append("channel",s.source.toLowerCase()),y.append("direction","inbound"),y.append("summary",`Initial complaint via ${s.source}`),y.append("occurred_at",s.received_at),y.append("is_final_response","false"),y.append("files",a);try{yield B.post(`/complaints/${p}/communications`,y,{headers:{"Content-Type":"multipart/form-data"}})}catch(f){console.error("Failed to upload attachment",f)}}c(`/complaints/${p}`,{state:{refreshDashboard:!0}})});return t.jsxs(Z,{children:[t.jsx(j,{variant:"h5",gutterBottom:!0,children:"Create complaint"}),t.jsx(sr,{activeStep:n,sx:{mb:2},children:Kn.map(u=>t.jsx(rr,{children:t.jsx(ar,{children:u})},u))}),t.jsx(re,{children:t.jsxs(ae,{children:[n===0&&t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{label:"Full name",fullWidth:!0,value:s.complainant.full_name,onChange:u=>o("complainant.full_name",u.target.value)})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{label:"Email",fullWidth:!0,value:s.complainant.email||"",onChange:u=>o("complainant.email",u.target.value)})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{label:"Phone",fullWidth:!0,value:s.complainant.phone||"",onChange:u=>o("complainant.phone",u.target.value)})}),t.jsx(A,{item:!0,xs:12,children:t.jsx(yt,{control:t.jsx(zt,{checked:s.vulnerability_flag,onChange:u=>o("vulnerability_flag",u.target.checked)}),label:"Vulnerable customer"})})]}),n===1&&t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,children:t.jsx(z,{label:"Description",fullWidth:!0,multiline:!0,rows:3,helperText:"Brief summary of the complaint",value:s.description,onChange:u=>o("description",u.target.value)})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{select:!0,label:"Category (FCA-aligned)",fullWidth:!0,value:s.category,onChange:u=>{const p=u.target.value;o("category",p),p==="Vulnerability and Customer Treatment"&&o("vulnerability_flag",!0)},helperText:"Choose one primary category",children:Gn.map(u=>t.jsx(G,{value:u,children:u},u))})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{label:"Reason / sub-category",fullWidth:!0,multiline:!0,minRows:2,value:s.reason||"",onChange:u=>o("reason",u.target.value),helperText:"Add specific reason(s); multiple allowed"})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{select:!0,label:"Channel",fullWidth:!0,value:s.source,onChange:u=>o("source",u.target.value),helperText:"How the complaint was received",children:["Phone","Email","Letter","Web","In Person","Other"].map(u=>t.jsx(G,{value:u,children:u},u))})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{label:"Date complaint received",type:"date",fullWidth:!0,value:se(s.received_at).format("YYYY-MM-DD"),onChange:u=>o("received_at",se(u.target.value).toISOString()),InputLabelProps:{shrink:!0}})}),(s.source==="Email"||s.source==="Letter")&&t.jsxs(A,{item:!0,xs:12,children:[t.jsxs(U,{variant:"outlined",component:"label",children:["Attach file (PDF preferred)",t.jsx("input",{hidden:!0,type:"file",accept:".pdf,.png,.jpg,.jpeg,.txt",onChange:u=>{var p;return l(((p=u.target.files)==null?void 0:p[0])||null)}})]}),t.jsxs(j,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:["For emails/letters, please upload a PDF print (avoid .eml/.msg). Selected: ",(a==null?void 0:a.name)||"none"]})]})]}),n===2&&t.jsxs(A,{container:!0,spacing:2,children:[t.jsx(A,{item:!0,xs:12,md:6,children:t.jsx(z,{label:"Policy number or Claim Reference",fullWidth:!0,value:s.policy.policy_number||"",onChange:u=>{o("policy.policy_number",u.target.value),o("policy_number",u.target.value)}})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsxs(z,{select:!0,label:"Product",fullWidth:!0,value:s.policy.product||"",onChange:u=>{o("policy.product",u.target.value),o("product",u.target.value)},helperText:"Select from reference data",children:[t.jsx(G,{value:"",children:"(None)"}),d.products.map(u=>t.jsx(G,{value:u.name,children:u.name},u.id))]})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsxs(z,{select:!0,label:"Insurer",fullWidth:!0,value:s.policy.insurer||"",onChange:u=>{o("policy.insurer",u.target.value),o("insurer",u.target.value)},helperText:"Select from reference data",children:[t.jsx(G,{value:"",children:"(None)"}),d.insurers.map(u=>t.jsx(G,{value:u.name,children:u.name},u.id))]})}),t.jsx(A,{item:!0,xs:12,md:6,children:t.jsxs(z,{select:!0,label:"Broker",fullWidth:!0,value:s.policy.broker||"",onChange:u=>{o("policy.broker",u.target.value),o("broker",u.target.value)},helperText:"Select from reference data",children:[t.jsx(G,{value:"",children:"(None)"}),d.brokers.map(u=>t.jsx(G,{value:u.name,children:u.name},u.id))]})})]})]})}),t.jsxs(Z,{mt:2,display:"flex",justifyContent:"space-between",children:[t.jsx(U,{disabled:n===0,onClick:()=>e(u=>u-1),children:"Back"}),n<Kn.length-1?t.jsx(U,{variant:"contained",onClick:()=>e(u=>u+1),children:"Next"}):t.jsx(U,{variant:"contained",onClick:i,children:"Submit"})]})]})}const Xn=[{value:"admin",label:"Admin"},{value:"complaints_handler",label:"Complaints Handler"},{value:"complaints_manager",label:"Complaints Manager"},{value:"reviewer",label:"Reviewer"},{value:"read_only",label:"Read only"}];function di(){const{role:n}=tt(),[e,s]=w.useState([]),[r,a]=w.useState(!1),[l,d]=w.useState(!1),[h,c]=w.useState(!1),[o,i]=w.useState(null),[u,p]=w.useState(null),[y,f]=w.useState({}),[b,g]=w.useState(null),[S,O]=w.useState({email:"",full_name:"",password:"",role:"complaints_handler",is_active:!0}),C=()=>q(this,null,function*(){var P,I;a(!0),i(null);try{const E=yield B.get("/users");s(E.data)}catch(E){i(((I=(P=E==null?void 0:E.response)==null?void 0:P.data)==null?void 0:I.detail)||"Failed to load users")}finally{a(!1)}});w.useEffect(()=>{C()},[]);const k=()=>q(this,null,function*(){var P,I;d(!0),i(null);try{yield B.post("/users",S),O({email:"",full_name:"",password:"",role:"complaints_handler",is_active:!0}),yield C()}catch(E){i(((I=(P=E==null?void 0:E.response)==null?void 0:P.data)==null?void 0:I.detail)||"Failed to create user")}finally{d(!1)}}),N=(P,I)=>q(this,null,function*(){var E,V;d(!0),i(null);try{yield B.patch(`/users/${P}`,I),yield C()}catch(ee){i(((V=(E=ee==null?void 0:ee.response)==null?void 0:E.data)==null?void 0:V.detail)||"Failed to update user")}finally{d(!1)}}),J=P=>q(this,null,function*(){var I,E;d(!0),i(null);try{yield B.post(`/auth/mfa/reset/${P}`),yield C()}catch(V){i(((E=(I=V==null?void 0:V.response)==null?void 0:I.data)==null?void 0:E.detail)||"Failed to reset MFA")}finally{d(!1)}}),te=(P,I)=>q(this,null,function*(){var E,V;d(!0),i(null);try{const ee=yield B.post(`/users/${P}/reset-password`);g({open:!0,email:I,tempPassword:ee.data.temporary_password}),yield C()}catch(ee){i(((V=(E=ee==null?void 0:ee.response)==null?void 0:E.data)==null?void 0:V.detail)||"Failed to reset password")}finally{d(!1)}}),de=P=>q(this,null,function*(){var I,E;c(!0),i(null);try{const V=yield B.post(`/auth/mfa/recovery/${P}/regenerate`);f(ee=>fe(ne({},ee),{[P]:V.data.recovery_codes})),p(P)}catch(V){i(((E=(I=V==null?void 0:V.response)==null?void 0:I.data)==null?void 0:E.detail)||"Failed to get recovery codes")}finally{c(!1)}});return n!=="admin"?t.jsxs(Z,{children:[t.jsx(j,{variant:"h6",gutterBottom:!0,children:"Admin only"}),t.jsx(j,{color:"text.secondary",children:"You need admin rights to manage users."})]}):t.jsxs(Z,{children:[t.jsx(j,{variant:"h5",gutterBottom:!0,children:"User management"}),(b==null?void 0:b.open)&&t.jsxs(bt,{open:!0,onClose:()=>g(null),maxWidth:"sm",fullWidth:!0,children:[t.jsx(jt,{children:"Password reset"}),t.jsx(wt,{children:t.jsxs(H,{spacing:2,sx:{mt:1},children:[t.jsx(ze,{severity:"warning",children:"This user will be forced to change their password on next login. Copy the temporary password and email it to them."}),t.jsxs(j,{variant:"body2",children:["User: ",t.jsx("strong",{children:b.email})]}),t.jsx(z,{label:"Temporary password",value:b.tempPassword,fullWidth:!0,InputProps:{readOnly:!0}}),t.jsx(U,{variant:"outlined",onClick:()=>q(this,null,function*(){try{yield navigator.clipboard.writeText(b.tempPassword)}catch(P){}}),children:"Copy to clipboard"})]})}),t.jsx(vt,{children:t.jsx(U,{onClick:()=>g(null),children:"Done"})})]}),t.jsxs(H,{direction:{xs:"column",md:"row"},spacing:3,children:[t.jsx(re,{sx:{flex:1},children:t.jsxs(ae,{children:[t.jsxs(H,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[t.jsx(j,{variant:"h6",children:"Users"}),t.jsx(U,{onClick:C,disabled:r||l,children:"Refresh"})]}),o&&t.jsx(j,{color:"error",variant:"body2",sx:{mb:2},children:o}),t.jsxs(Qt,{size:"small",children:[t.jsx(Kt,{children:t.jsxs(Se,{children:[t.jsx(Q,{children:"Email"}),t.jsx(Q,{children:"Name"}),t.jsx(Q,{children:"Role"}),t.jsx(Q,{children:"MFA"}),t.jsx(Q,{children:"Status"}),t.jsx(Q,{align:"right",children:"Actions"})]})}),t.jsxs(Gt,{children:[e.map(P=>{const I=u===P.id;return t.jsxs(Ue.Fragment,{children:[t.jsxs(Se,{hover:!0,sx:{cursor:"pointer"},onClick:()=>I?p(null):de(P.id),children:[t.jsx(Q,{children:P.email}),t.jsx(Q,{children:P.full_name}),t.jsx(Q,{onClick:E=>E.stopPropagation(),children:t.jsx(z,{select:!0,size:"small",value:P.role,onChange:E=>N(P.id,{role:E.target.value}),children:Xn.map(E=>t.jsx(G,{value:E.value,children:E.label},E.value))})}),t.jsx(Q,{children:t.jsx(xe,{label:P.mfa_enabled?"Enabled":"Disabled",color:P.mfa_enabled?"success":"default",size:"small"})}),t.jsx(Q,{children:t.jsx(xe,{label:P.is_active?"Active":"Disabled",color:P.is_active?"success":"default",size:"small"})}),t.jsx(Q,{align:"right",onClick:E=>E.stopPropagation(),children:t.jsxs(H,{direction:"row",spacing:1,justifyContent:"flex-end",alignItems:"center",children:[t.jsx(zt,{checked:P.is_active,onChange:E=>N(P.id,{is_active:E.target.checked}),size:"small"}),t.jsx(U,{variant:"outlined",size:"small",onClick:()=>te(P.id,P.email),disabled:l,children:"Reset password"}),t.jsx(U,{variant:"outlined",size:"small",onClick:()=>J(P.id),disabled:l,children:"Reset MFA"})]})})]}),I&&t.jsx(Se,{children:t.jsx(Q,{colSpan:6,children:t.jsxs(H,{spacing:1,children:[t.jsx(j,{variant:"subtitle2",children:"Recovery codes"}),h?t.jsx(j,{variant:"body2",color:"text.secondary",children:"Loading..."}):t.jsxs(H,{direction:"row",gap:1,flexWrap:"wrap",children:[(y[P.id]||[]).map(E=>t.jsx(Z,{sx:{border:"1px solid #ddd",px:1.5,py:.5,borderRadius:1,fontFamily:"monospace"},children:E},E)),(!y[P.id]||y[P.id].length===0)&&t.jsx(j,{variant:"body2",color:"text.secondary",children:"No codes available."})]})]})})})]},P.id)}),e.length===0&&t.jsx(Se,{children:t.jsx(Q,{colSpan:5,children:r?"Loading...":"No users"})})]})]})]})}),t.jsx(re,{sx:{width:{xs:"100%",md:360}},children:t.jsxs(ae,{children:[t.jsx(j,{variant:"h6",gutterBottom:!0,children:"Create user"}),t.jsxs(H,{spacing:2,children:[t.jsx(z,{label:"Email",value:S.email,onChange:P=>O(I=>fe(ne({},I),{email:P.target.value})),fullWidth:!0,size:"small"}),t.jsx(z,{label:"Full name",value:S.full_name,onChange:P=>O(I=>fe(ne({},I),{full_name:P.target.value})),fullWidth:!0,size:"small"}),t.jsx(z,{label:"Password",type:"password",value:S.password,onChange:P=>O(I=>fe(ne({},I),{password:P.target.value})),fullWidth:!0,size:"small"}),t.jsx(z,{label:"Role",select:!0,value:S.role,onChange:P=>O(I=>fe(ne({},I),{role:P.target.value})),size:"small",children:Xn.map(P=>t.jsx(G,{value:P.value,children:P.label},P.value))}),t.jsx(yt,{control:t.jsx(zt,{checked:S.is_active,onChange:P=>O(I=>fe(ne({},I),{is_active:P.target.checked})),size:"small"}),label:"Active"}),t.jsx(U,{variant:"contained",onClick:k,disabled:l||r,children:"Create user"})]})]})})]})]})}const Zn={products:"Products",brokers:"Brokers",insurers:"Insurers"};function ui(){const[n,e]=w.useState({products:[],brokers:[],insurers:[]}),[s,r]=w.useState(!1),[a,l]=w.useState(!1),[d,h]=w.useState(null),[c,o]=w.useState({products:"",brokers:"",insurers:""}),[i,u]=w.useState({products:null,brokers:null,insurers:null}),p=()=>q(this,null,function*(){var S,O;r(!0),h(null);try{const[C,k,N]=yield Promise.all([B.get("/reference/products"),B.get("/reference/brokers"),B.get("/reference/insurers")]);e({products:C.data,brokers:k.data,insurers:N.data})}catch(C){h(((O=(S=C==null?void 0:C.response)==null?void 0:S.data)==null?void 0:O.detail)||"Failed to load reference data")}finally{r(!1)}});w.useEffect(()=>{p()},[]);const y=S=>q(this,null,function*(){var C,k;const O=c[S].trim();if(O){l(!0),h(null);try{yield B.post(`/reference/${S}`,{name:O}),o(N=>fe(ne({},N),{[S]:""})),yield p()}catch(N){h(((k=(C=N==null?void 0:N.response)==null?void 0:C.data)==null?void 0:k.detail)||"Failed to create item")}finally{l(!1)}}}),f=S=>q(this,null,function*(){var C,k;const O=i[S];if(O){l(!0),h(null);try{const N=new FormData;N.append("file",O),yield B.post(`/reference/${S}/import`,N,{headers:{"Content-Type":"multipart/form-data"}}),u(J=>fe(ne({},J),{[S]:null})),yield p()}catch(N){h(((k=(C=N==null?void 0:N.response)==null?void 0:C.data)==null?void 0:k.detail)||"Failed to import CSV")}finally{l(!1)}}}),b=S=>{const O=`name
Sample Name
`,C=new Blob([O],{type:"text/csv"}),k=URL.createObjectURL(C),N=document.createElement("a");N.href=k,N.download=`${S}_template.csv`,N.click(),URL.revokeObjectURL(k)},g=({kind:S})=>{var O;return t.jsx(re,{sx:{flex:1},children:t.jsxs(ae,{children:[t.jsxs(H,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[t.jsx(j,{variant:"h6",children:Zn[S]}),t.jsx(U,{onClick:()=>b(S),children:"Download CSV template"})]}),t.jsxs(H,{direction:{xs:"column",md:"row"},spacing:2,mb:2,children:[t.jsx(z,{label:`Add ${Zn[S].slice(0,-1)}`,size:"small",value:c[S],onChange:C=>o(k=>fe(ne({},k),{[S]:C.target.value})),fullWidth:!0}),t.jsx(U,{variant:"contained",onClick:()=>y(S),disabled:a,children:"Add"})]}),t.jsxs(H,{direction:{xs:"column",md:"row"},spacing:2,alignItems:"center",mb:2,children:[t.jsxs(U,{variant:"outlined",component:"label",disabled:a,children:["Choose CSV",t.jsx("input",{hidden:!0,type:"file",accept:".csv,text/csv",onChange:C=>u(k=>{var N;return fe(ne({},k),{[S]:((N=C.target.files)==null?void 0:N[0])||null})})})]}),t.jsx(j,{variant:"body2",color:"text.secondary",children:((O=i[S])==null?void 0:O.name)||"No file selected"}),t.jsx(U,{variant:"contained",onClick:()=>f(S),disabled:a||!i[S],children:"Import CSV"})]}),d&&t.jsx(j,{variant:"body2",color:"error",sx:{mb:1},children:d}),t.jsxs(Qt,{size:"small",children:[t.jsx(Kt,{children:t.jsxs(Se,{children:[t.jsx(Q,{children:"Name"}),t.jsx(Q,{children:"Created"})]})}),t.jsxs(Gt,{children:[n[S].map(C=>t.jsxs(Se,{children:[t.jsx(Q,{children:C.name}),t.jsx(Q,{children:new Date(C.created_at).toLocaleString()})]},C.id)),n[S].length===0&&t.jsx(Se,{children:t.jsx(Q,{colSpan:2,children:s?"Loading...":"No records"})})]})]})]})})};return t.jsxs(Z,{children:[t.jsx(j,{variant:"h5",gutterBottom:!0,children:"Reference data"}),t.jsx(j,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Manage products, brokers, and insurers. Add individually or import via CSV (column: name)."}),t.jsxs(H,{spacing:3,children:[t.jsx(g,{kind:"products"}),t.jsx(g,{kind:"brokers"}),t.jsx(g,{kind:"insurers"})]})]})}function hi(){var C;const{name:n,mustChangePassword:e,refreshMe:s}=tt(),a=!!((C=Xt().state)!=null&&C.forced)||e,[l,d]=w.useState(""),[h,c]=w.useState(""),[o,i]=w.useState(""),[u,p]=w.useState(!1),[y,f]=w.useState(null),[b,g]=w.useState(null),S=w.useMemo(()=>!(!h||h.length<8||h!==o||!l),[h,o,l]),O=()=>q(this,null,function*(){var k,N;p(!0),f(null),g(null);try{yield B.post("/auth/password/change",{current_password:l,new_password:h}),d(""),c(""),i(""),yield s(),g("Password updated.")}catch(J){f(((N=(k=J==null?void 0:J.response)==null?void 0:k.data)==null?void 0:N.detail)||"Failed to update password")}finally{p(!1)}});return t.jsxs(Z,{children:[t.jsx(j,{variant:"h5",gutterBottom:!0,children:"Profile"}),t.jsxs(j,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Signed in as ",n||""]}),t.jsx(re,{sx:{maxWidth:520,mt:2},children:t.jsx(ae,{children:t.jsxs(H,{spacing:2,children:[a&&t.jsx(ze,{severity:"warning",children:"Your password has been reset by an admin. You must set a new password before continuing."}),y&&t.jsx(ze,{severity:"error",children:y}),b&&t.jsx(ze,{severity:"success",children:b}),t.jsx(j,{variant:"subtitle1",children:"Change password"}),t.jsx(z,{label:"Current password",type:"password",value:l,onChange:k=>d(k.target.value),fullWidth:!0}),t.jsx(z,{label:"New password (min 8 chars)",type:"password",value:h,onChange:k=>c(k.target.value),fullWidth:!0}),t.jsx(z,{label:"Confirm new password",type:"password",value:o,onChange:k=>i(k.target.value),fullWidth:!0}),t.jsx(U,{variant:"contained",onClick:O,disabled:!S||u,children:"Update password"})]})})})]})}var fi=Object.defineProperty,_t=Object.getOwnPropertySymbols,Os=Object.prototype.hasOwnProperty,Ms=Object.prototype.propertyIsEnumerable,es=(n,e,s)=>e in n?fi(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,mi=(n,e)=>{for(var s in e||(e={}))Os.call(e,s)&&es(n,s,e[s]);if(_t)for(var s of _t(e))Ms.call(e,s)&&es(n,s,e[s]);return n},pi=(n,e)=>{var s={};for(var r in n)Os.call(n,r)&&e.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&_t)for(var r of _t(n))e.indexOf(r)<0&&Ms.call(n,r)&&(s[r]=n[r]);return s};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Le;(n=>{const e=class{constructor(c,o,i,u){if(this.version=c,this.errorCorrectionLevel=o,this.modules=[],this.isFunction=[],c<e.MIN_VERSION||c>e.MAX_VERSION)throw new RangeError("Version value out of range");if(u<-1||u>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let p=[];for(let f=0;f<this.size;f++)p.push(!1);for(let f=0;f<this.size;f++)this.modules.push(p.slice()),this.isFunction.push(p.slice());this.drawFunctionPatterns();const y=this.addEccAndInterleave(i);if(this.drawCodewords(y),u==-1){let f=1e9;for(let b=0;b<8;b++){this.applyMask(b),this.drawFormatBits(b);const g=this.getPenaltyScore();g<f&&(u=b,f=g),this.applyMask(b)}}l(0<=u&&u<=7),this.mask=u,this.applyMask(u),this.drawFormatBits(u),this.isFunction=[]}static encodeText(c,o){const i=n.QrSegment.makeSegments(c);return e.encodeSegments(i,o)}static encodeBinary(c,o){const i=n.QrSegment.makeBytes(c);return e.encodeSegments([i],o)}static encodeSegments(c,o,i=1,u=40,p=-1,y=!0){if(!(e.MIN_VERSION<=i&&i<=u&&u<=e.MAX_VERSION)||p<-1||p>7)throw new RangeError("Invalid value");let f,b;for(f=i;;f++){const C=e.getNumDataCodewords(f,o)*8,k=h.getTotalBits(c,f);if(k<=C){b=k;break}if(f>=u)throw new RangeError("Data too long")}for(const C of[e.Ecc.MEDIUM,e.Ecc.QUARTILE,e.Ecc.HIGH])y&&b<=e.getNumDataCodewords(f,C)*8&&(o=C);let g=[];for(const C of c){r(C.mode.modeBits,4,g),r(C.numChars,C.mode.numCharCountBits(f),g);for(const k of C.getData())g.push(k)}l(g.length==b);const S=e.getNumDataCodewords(f,o)*8;l(g.length<=S),r(0,Math.min(4,S-g.length),g),r(0,(8-g.length%8)%8,g),l(g.length%8==0);for(let C=236;g.length<S;C^=253)r(C,8,g);let O=[];for(;O.length*8<g.length;)O.push(0);return g.forEach((C,k)=>O[k>>>3]|=C<<7-(k&7)),new e(f,o,O,p)}getModule(c,o){return 0<=c&&c<this.size&&0<=o&&o<this.size&&this.modules[o][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let i=0;i<this.size;i++)this.setFunctionModule(6,i,i%2==0),this.setFunctionModule(i,6,i%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),o=c.length;for(let i=0;i<o;i++)for(let u=0;u<o;u++)i==0&&u==0||i==0&&u==o-1||i==o-1&&u==0||this.drawAlignmentPattern(c[i],c[u]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const o=this.errorCorrectionLevel.formatBits<<3|c;let i=o;for(let p=0;p<10;p++)i=i<<1^(i>>>9)*1335;const u=(o<<10|i)^21522;l(u>>>15==0);for(let p=0;p<=5;p++)this.setFunctionModule(8,p,a(u,p));this.setFunctionModule(8,7,a(u,6)),this.setFunctionModule(8,8,a(u,7)),this.setFunctionModule(7,8,a(u,8));for(let p=9;p<15;p++)this.setFunctionModule(14-p,8,a(u,p));for(let p=0;p<8;p++)this.setFunctionModule(this.size-1-p,8,a(u,p));for(let p=8;p<15;p++)this.setFunctionModule(8,this.size-15+p,a(u,p));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let i=0;i<12;i++)c=c<<1^(c>>>11)*7973;const o=this.version<<12|c;l(o>>>18==0);for(let i=0;i<18;i++){const u=a(o,i),p=this.size-11+i%3,y=Math.floor(i/3);this.setFunctionModule(p,y,u),this.setFunctionModule(y,p,u)}}drawFinderPattern(c,o){for(let i=-4;i<=4;i++)for(let u=-4;u<=4;u++){const p=Math.max(Math.abs(u),Math.abs(i)),y=c+u,f=o+i;0<=y&&y<this.size&&0<=f&&f<this.size&&this.setFunctionModule(y,f,p!=2&&p!=4)}}drawAlignmentPattern(c,o){for(let i=-2;i<=2;i++)for(let u=-2;u<=2;u++)this.setFunctionModule(c+u,o+i,Math.max(Math.abs(u),Math.abs(i))!=1)}setFunctionModule(c,o,i){this.modules[o][c]=i,this.isFunction[o][c]=!0}addEccAndInterleave(c){const o=this.version,i=this.errorCorrectionLevel;if(c.length!=e.getNumDataCodewords(o,i))throw new RangeError("Invalid argument");const u=e.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][o],p=e.ECC_CODEWORDS_PER_BLOCK[i.ordinal][o],y=Math.floor(e.getNumRawDataModules(o)/8),f=u-y%u,b=Math.floor(y/u);let g=[];const S=e.reedSolomonComputeDivisor(p);for(let C=0,k=0;C<u;C++){let N=c.slice(k,k+b-p+(C<f?0:1));k+=N.length;const J=e.reedSolomonComputeRemainder(N,S);C<f&&N.push(0),g.push(N.concat(J))}let O=[];for(let C=0;C<g[0].length;C++)g.forEach((k,N)=>{(C!=b-p||N>=f)&&O.push(k[C])});return l(O.length==y),O}drawCodewords(c){if(c.length!=Math.floor(e.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let o=0;for(let i=this.size-1;i>=1;i-=2){i==6&&(i=5);for(let u=0;u<this.size;u++)for(let p=0;p<2;p++){const y=i-p,b=(i+1&2)==0?this.size-1-u:u;!this.isFunction[b][y]&&o<c.length*8&&(this.modules[b][y]=a(c[o>>>3],7-(o&7)),o++)}}l(o==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let o=0;o<this.size;o++)for(let i=0;i<this.size;i++){let u;switch(c){case 0:u=(i+o)%2==0;break;case 1:u=o%2==0;break;case 2:u=i%3==0;break;case 3:u=(i+o)%3==0;break;case 4:u=(Math.floor(i/3)+Math.floor(o/2))%2==0;break;case 5:u=i*o%2+i*o%3==0;break;case 6:u=(i*o%2+i*o%3)%2==0;break;case 7:u=((i+o)%2+i*o%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[o][i]&&u&&(this.modules[o][i]=!this.modules[o][i])}}getPenaltyScore(){let c=0;for(let p=0;p<this.size;p++){let y=!1,f=0,b=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[p][g]==y?(f++,f==5?c+=e.PENALTY_N1:f>5&&c++):(this.finderPenaltyAddHistory(f,b),y||(c+=this.finderPenaltyCountPatterns(b)*e.PENALTY_N3),y=this.modules[p][g],f=1);c+=this.finderPenaltyTerminateAndCount(y,f,b)*e.PENALTY_N3}for(let p=0;p<this.size;p++){let y=!1,f=0,b=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[g][p]==y?(f++,f==5?c+=e.PENALTY_N1:f>5&&c++):(this.finderPenaltyAddHistory(f,b),y||(c+=this.finderPenaltyCountPatterns(b)*e.PENALTY_N3),y=this.modules[g][p],f=1);c+=this.finderPenaltyTerminateAndCount(y,f,b)*e.PENALTY_N3}for(let p=0;p<this.size-1;p++)for(let y=0;y<this.size-1;y++){const f=this.modules[p][y];f==this.modules[p][y+1]&&f==this.modules[p+1][y]&&f==this.modules[p+1][y+1]&&(c+=e.PENALTY_N2)}let o=0;for(const p of this.modules)o=p.reduce((y,f)=>y+(f?1:0),o);const i=this.size*this.size,u=Math.ceil(Math.abs(o*20-i*10)/i)-1;return l(0<=u&&u<=9),c+=u*e.PENALTY_N4,l(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,o=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let i=[6];for(let u=this.size-7;i.length<c;u-=o)i.splice(1,0,u);return i}}static getNumRawDataModules(c){if(c<e.MIN_VERSION||c>e.MAX_VERSION)throw new RangeError("Version number out of range");let o=(16*c+128)*c+64;if(c>=2){const i=Math.floor(c/7)+2;o-=(25*i-10)*i-55,c>=7&&(o-=36)}return l(208<=o&&o<=29648),o}static getNumDataCodewords(c,o){return Math.floor(e.getNumRawDataModules(c)/8)-e.ECC_CODEWORDS_PER_BLOCK[o.ordinal][c]*e.NUM_ERROR_CORRECTION_BLOCKS[o.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let o=[];for(let u=0;u<c-1;u++)o.push(0);o.push(1);let i=1;for(let u=0;u<c;u++){for(let p=0;p<o.length;p++)o[p]=e.reedSolomonMultiply(o[p],i),p+1<o.length&&(o[p]^=o[p+1]);i=e.reedSolomonMultiply(i,2)}return o}static reedSolomonComputeRemainder(c,o){let i=o.map(u=>0);for(const u of c){const p=u^i.shift();i.push(0),o.forEach((y,f)=>i[f]^=e.reedSolomonMultiply(y,p))}return i}static reedSolomonMultiply(c,o){if(c>>>8||o>>>8)throw new RangeError("Byte out of range");let i=0;for(let u=7;u>=0;u--)i=i<<1^(i>>>7)*285,i^=(o>>>u&1)*c;return l(i>>>8==0),i}finderPenaltyCountPatterns(c){const o=c[1];l(o<=this.size*3);const i=o>0&&c[2]==o&&c[3]==o*3&&c[4]==o&&c[5]==o;return(i&&c[0]>=o*4&&c[6]>=o?1:0)+(i&&c[6]>=o*4&&c[0]>=o?1:0)}finderPenaltyTerminateAndCount(c,o,i){return c&&(this.finderPenaltyAddHistory(o,i),o=0),o+=this.size,this.finderPenaltyAddHistory(o,i),this.finderPenaltyCountPatterns(i)}finderPenaltyAddHistory(c,o){o[0]==0&&(c+=this.size),o.pop(),o.unshift(c)}};let s=e;s.MIN_VERSION=1,s.MAX_VERSION=40,s.PENALTY_N1=3,s.PENALTY_N2=3,s.PENALTY_N3=40,s.PENALTY_N4=10,s.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],s.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n.QrCode=s;function r(c,o,i){if(o<0||o>31||c>>>o)throw new RangeError("Value out of range");for(let u=o-1;u>=0;u--)i.push(c>>>u&1)}function a(c,o){return(c>>>o&1)!=0}function l(c){if(!c)throw new Error("Assertion error")}const d=class{constructor(c,o,i){if(this.mode=c,this.numChars=o,this.bitData=i,o<0)throw new RangeError("Invalid argument");this.bitData=i.slice()}static makeBytes(c){let o=[];for(const i of c)r(i,8,o);return new d(d.Mode.BYTE,c.length,o)}static makeNumeric(c){if(!d.isNumeric(c))throw new RangeError("String contains non-numeric characters");let o=[];for(let i=0;i<c.length;){const u=Math.min(c.length-i,3);r(parseInt(c.substr(i,u),10),u*3+1,o),i+=u}return new d(d.Mode.NUMERIC,c.length,o)}static makeAlphanumeric(c){if(!d.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let o=[],i;for(i=0;i+2<=c.length;i+=2){let u=d.ALPHANUMERIC_CHARSET.indexOf(c.charAt(i))*45;u+=d.ALPHANUMERIC_CHARSET.indexOf(c.charAt(i+1)),r(u,11,o)}return i<c.length&&r(d.ALPHANUMERIC_CHARSET.indexOf(c.charAt(i)),6,o),new d(d.Mode.ALPHANUMERIC,c.length,o)}static makeSegments(c){return c==""?[]:d.isNumeric(c)?[d.makeNumeric(c)]:d.isAlphanumeric(c)?[d.makeAlphanumeric(c)]:[d.makeBytes(d.toUtf8ByteArray(c))]}static makeEci(c){let o=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)r(c,8,o);else if(c<16384)r(2,2,o),r(c,14,o);else if(c<1e6)r(6,3,o),r(c,21,o);else throw new RangeError("ECI assignment value out of range");return new d(d.Mode.ECI,0,o)}static isNumeric(c){return d.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return d.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,o){let i=0;for(const u of c){const p=u.mode.numCharCountBits(o);if(u.numChars>=1<<p)return 1/0;i+=4+p+u.bitData.length}return i}static toUtf8ByteArray(c){c=encodeURI(c);let o=[];for(let i=0;i<c.length;i++)c.charAt(i)!="%"?o.push(c.charCodeAt(i)):(o.push(parseInt(c.substr(i+1,2),16)),i+=2);return o}};let h=d;h.NUMERIC_REGEX=/^[0-9]*$/,h.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,h.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",n.QrSegment=h})(Le||(Le={}));(n=>{(e=>{const s=class{constructor(a,l){this.ordinal=a,this.formatBits=l}};let r=s;r.LOW=new s(0,1),r.MEDIUM=new s(1,0),r.QUARTILE=new s(2,3),r.HIGH=new s(3,2),e.Ecc=r})(n.QrCode||(n.QrCode={}))})(Le||(Le={}));(n=>{(e=>{const s=class{constructor(a,l){this.modeBits=a,this.numBitsCharCount=l}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};let r=s;r.NUMERIC=new s(1,[10,12,14]),r.ALPHANUMERIC=new s(2,[9,11,13]),r.BYTE=new s(4,[8,16,16]),r.KANJI=new s(8,[8,10,12]),r.ECI=new s(7,[0,0,0]),e.Mode=r})(n.QrSegment||(n.QrSegment={}))})(Le||(Le={}));var Ke=Le;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var xi={L:Ke.QrCode.Ecc.LOW,M:Ke.QrCode.Ecc.MEDIUM,Q:Ke.QrCode.Ecc.QUARTILE,H:Ke.QrCode.Ecc.HIGH},gi=128,yi="L",bi="#FFFFFF",ji="#000000",wi=!1,Ps=4,vi=.1;function Ci(n,e=0){const s=[];return n.forEach(function(r,a){let l=null;r.forEach(function(d,h){if(!d&&l!==null){s.push(`M${l+e} ${a+e}h${h-l}v1H${l+e}z`),l=null;return}if(h===r.length-1){if(!d)return;l===null?s.push(`M${h+e},${a+e} h1v1H${h+e}z`):s.push(`M${l+e},${a+e} h${h+1-l}v1H${l+e}z`);return}d&&l===null&&(l=h)})}),s.join("")}function Si(n,e){return n.slice().map((s,r)=>r<e.y||r>=e.y+e.h?s:s.map((a,l)=>l<e.x||l>=e.x+e.w?a:!1))}function _i(n,e,s,r){if(r==null)return null;const a=s?Ps:0,l=n.length+a*2,d=Math.floor(e*vi),h=l/e,c=(r.width||d)*h,o=(r.height||d)*h,i=r.x==null?n.length/2-c/2:r.x*h,u=r.y==null?n.length/2-o/2:r.y*h;let p=null;if(r.excavate){let y=Math.floor(i),f=Math.floor(u),b=Math.ceil(c+i-y),g=Math.ceil(o+u-f);p={x:y,y:f,w:b,h:g}}return{x:i,y:u,h:o,w:c,excavation:p}}(function(){try{new Path2D().addPath(new Path2D)}catch(n){return!1}return!0})();function Ei(n){const e=n,{value:s,size:r=gi,level:a=yi,bgColor:l=bi,fgColor:d=ji,includeMargin:h=wi,imageSettings:c}=e,o=pi(e,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let i=Ke.QrCode.encodeText(s,xi[a]).getModules();const u=h?Ps:0,p=i.length+u*2,y=_i(i,r,h,c);let f=null;c!=null&&y!=null&&(y.excavation!=null&&(i=Si(i,y.excavation)),f=Ue.createElement("image",{xlinkHref:c.src,height:y.h,width:y.w,x:y.x+u,y:y.y+u,preserveAspectRatio:"none"}));const b=Ci(i,u);return Ue.createElement("svg",mi({height:r,width:r,viewBox:`0 0 ${p} ${p}`},o),Ue.createElement("path",{fill:l,d:`M0,0 h${p}v${p}H0z`,shapeRendering:"crispEdges"}),Ue.createElement("path",{fill:d,d:b,shapeRendering:"crispEdges"}),f)}new URL("/assets/compass-logo-D3WIe7Ai.png",import.meta.url).href;function Ri(){const{token:n,role:e,name:s,login:r,logout:a,mustChangePassword:l,ready:d}=tt(),[h,c]=w.useState(""),[o,i]=w.useState(""),[u,p]=w.useState(!1),[y,f]=w.useState(""),[b,g]=w.useState(""),[S,O]=w.useState(null),[C,k]=w.useState(!1),[N,J]=w.useState(!1),[te,de]=w.useState(null),[P,I]=w.useState(null),[E,V]=w.useState(0),[ee,T]=w.useState(!1),R=Et(),v=Xt();w.useEffect(()=>{T(!n)},[n]),w.useEffect(()=>{d&&(n||v.pathname!=="/"&&R("/",{replace:!0}))},[d,n,v.pathname,R]),w.useEffect(()=>{n&&l&&v.pathname!=="/profile"&&R("/profile",{replace:!0,state:{forced:!0}})},[n,l,v.pathname,R]);const D=()=>q(this,null,function*(){var M,W;O(null);try{const F=yield r(h,o,C?y:void 0,C?b:void 0);k(!1),f(""),g(""),F!=null&&F.mfa_enrollment_required?(V(F.mfa_remaining_skips||0),yield _()):R("/")}catch(F){const K=(W=(M=F==null?void 0:F.response)==null?void 0:M.data)==null?void 0:W.detail;K==="MFA code required"||(K==null?void 0:K.code)==="mfa_required"?(k(!0),O("Enter your 6-digit MFA code or a recovery code.")):O(K==="Invalid recovery code"||K==="Invalid MFA code"||K==="Invalid code"?"Invalid code. Please try again.":"Login failed. Check your credentials.")}}),_=()=>q(this,null,function*(){var M,W;try{const F=yield B.post("/auth/mfa/enroll");de(F.data),I(null),J(!0)}catch(F){O(((W=(M=F==null?void 0:F.response)==null?void 0:M.data)==null?void 0:W.detail)||"Could not start MFA enrollment")}}),$=()=>q(this,null,function*(){var M,W;try{const F=yield B.post("/auth/mfa/verify",{code:y});I(F.data.recovery_codes),J(!1),f(""),V(0),R("/")}catch(F){O(((W=(M=F==null?void 0:F.response)==null?void 0:M.data)==null?void 0:W.detail)||"Invalid code")}}),L=()=>q(this,null,function*(){var M,W;try{const F=yield B.post("/auth/mfa/skip");V(F.data.remaining_skips),J(!1),de(null)}catch(F){O(((W=(M=F==null?void 0:F.response)==null?void 0:M.data)==null?void 0:W.detail)||"Cannot skip MFA")}});return t.jsxs(t.Fragment,{children:[t.jsx(ir,{position:"static",color:"transparent",elevation:0,sx:{borderBottom:"1px solid rgba(255,255,255,0.08)",background:"linear-gradient(135deg, #0f172a 0%, #0f4c81 100%)",color:"#e5e7eb"},children:t.jsx(An,{maxWidth:"lg",children:t.jsxs(or,{disableGutters:!0,sx:{py:1.5,minHeight:72},children:[t.jsx(H,{direction:"row",alignItems:"center",spacing:1.6,sx:{flexGrow:1},children:t.jsx(j,{variant:"h5",sx:{fontWeight:800,letterSpacing:.4,color:"#f8fafc"},children:t.jsx(Ee,{to:"/",style:{color:"inherit",textDecoration:"none"},children:"Compass"})})}),n&&t.jsxs(H,{direction:"row",gap:1.5,alignItems:"center",children:[t.jsx(j,{variant:"body2",sx:{color:"rgba(255,255,255,0.85)"},children:s}),t.jsx(U,{color:"inherit",component:Ee,to:"/",sx:{fontWeight:700,color:"#f8fafc"},children:"Dashboard"}),t.jsx(U,{color:"inherit",component:Ee,to:"/complaints",sx:{fontWeight:700,color:"#f8fafc"},children:"Complaints"}),t.jsx(U,{color:"inherit",component:Ee,to:"/profile",sx:{fontWeight:700,color:"#f8fafc"},children:"Profile"}),t.jsx(U,{color:"inherit",component:Ee,to:"/complaints/new",disabled:e==="read_only",sx:{fontWeight:700,color:"#f8fafc"},children:"New"}),e==="admin"&&t.jsx(U,{color:"inherit",component:Ee,to:"/admin",sx:{fontWeight:700,color:"#f8fafc"},children:"Admin"}),e==="admin"&&t.jsx(U,{color:"inherit",component:Ee,to:"/reference",sx:{fontWeight:700,color:"#f8fafc"},children:"Reference"}),t.jsx(U,{color:"inherit",onClick:a,sx:{fontWeight:700,color:"#f8fafc"},children:"Logout"})]})]})})}),t.jsx(An,{maxWidth:"lg",sx:{mt:4,mb:4},children:n?t.jsxs(br,{children:[t.jsx(ke,{path:"/",element:t.jsx(ni,{})}),t.jsx(ke,{path:"/complaints",element:t.jsx(ai,{})}),t.jsx(ke,{path:"/complaints/new",element:t.jsx(ci,{})}),t.jsx(ke,{path:"/complaints/:id",element:t.jsx(li,{})}),t.jsx(ke,{path:"/profile",element:t.jsx(hi,{})}),t.jsx(ke,{path:"/admin",element:t.jsx(di,{})}),t.jsx(ke,{path:"/reference",element:t.jsx(ui,{})})]}):t.jsx(Z,{maxWidth:420,mx:"auto",mt:6,children:t.jsx(re,{children:t.jsxs(ae,{sx:{p:4},children:[ee&&t.jsx(ze,{severity:"info",sx:{mb:2},children:"Please log in to continue."}),t.jsxs(j,{variant:"h5",gutterBottom:!0,children:["Sign in ",!1]}),t.jsx(j,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Use your credentials to access the complaints workspace."}),S&&t.jsx(j,{variant:"body2",color:"error",sx:{mb:1},children:S}),t.jsxs(Z,{component:"form",onSubmit:M=>{M.preventDefault(),D()},children:[t.jsx(z,{label:"Email",value:h,onChange:M=>c(M.target.value),fullWidth:!0,sx:{mb:2.5,mt:1},autoComplete:"email"}),t.jsx(z,{label:"Password",type:u?"text":"password",value:o,onChange:M=>i(M.target.value),fullWidth:!0,sx:{mb:3},autoComplete:"current-password",InputProps:{endAdornment:t.jsx(lr,{position:"end",children:t.jsx(cr,{"aria-label":u?"Hide password":"Show password",onClick:()=>p(M=>!M),edge:"end",children:u?t.jsx(dr,{}):t.jsx(ur,{})})})}}),C&&t.jsxs(t.Fragment,{children:[t.jsx(z,{label:"MFA code (6 digits)",value:y,onChange:M=>f(M.target.value),fullWidth:!0,sx:{mb:2}}),t.jsx(z,{label:"Recovery code (optional)",value:b,onChange:M=>g(M.target.value),fullWidth:!0,sx:{mb:3}})]}),t.jsx(U,{variant:"contained",fullWidth:!0,size:"large",type:"submit",children:"Login"})]})]})})})}),t.jsxs(bt,{open:N,onClose:E>0?()=>J(!1):void 0,disableEscapeKeyDown:E<=0,children:[t.jsx(jt,{children:"Set up MFA"}),t.jsx(wt,{children:t.jsxs(H,{spacing:2,sx:{mt:1},children:[E<=0?t.jsx(j,{color:"error",children:"You must enable MFA to continue."}):t.jsxs(j,{children:["We recommend enabling MFA. You can skip up to ",E," more time(s)."]}),te?t.jsxs(t.Fragment,{children:[t.jsx(j,{variant:"subtitle2",children:"Scan in your authenticator app"}),t.jsx(Z,{display:"flex",justifyContent:"center",children:t.jsx(Ei,{value:te.otpauth_url,size:180})}),t.jsxs(j,{variant:"body2",children:["Secret (manual entry): ",te.secret]}),t.jsx(z,{label:"6-digit code",value:y,onChange:M=>f(M.target.value),size:"small",sx:{maxWidth:240}}),P&&t.jsxs(Z,{children:[t.jsx(j,{variant:"subtitle2",gutterBottom:!0,children:"Recovery codes (store securely)"}),t.jsx(H,{direction:"row",gap:1,flexWrap:"wrap",children:P.map(M=>t.jsx(Z,{sx:{border:"1px solid #ddd",px:1.5,py:.5,borderRadius:1,fontFamily:"monospace"},children:M},M))})]})]}):t.jsx(j,{color:"text.secondary",children:"Preparing enrollment..."})]})}),t.jsxs(vt,{sx:{px:3,pb:2},children:[t.jsx(U,{onClick:L,disabled:E<=0,children:"Skip for now"}),t.jsx(U,{variant:"contained",onClick:$,disabled:!y||y.length<6,children:"Verify & enable"})]})]})]})}const Ai=hr({palette:{mode:"light",primary:{main:"#0f4c81"},secondary:{main:"#0b6e4f"},background:{default:"#f5f7fb",paper:"#ffffff"},text:{primary:"#1b2430",secondary:"#4b5563"}},shape:{borderRadius:10},typography:{fontFamily:"'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif",h5:{fontWeight:600},h6:{fontWeight:600},subtitle2:{fontWeight:600,letterSpacing:.1}},components:{MuiCssBaseline:{styleOverrides:{body:{backgroundColor:"#f5f7fb"}}},MuiCard:{defaultProps:{elevation:0},styleOverrides:{root:{border:"1px solid #e5e7eb",boxShadow:"0 6px 18px rgba(15,76,129,0.06)"}}},MuiButton:{styleOverrides:{root:{textTransform:"none",borderRadius:10,fontWeight:600}}},MuiTextField:{defaultProps:{size:"small"}},MuiPaper:{styleOverrides:{root:{borderRadius:12}}}}});Wt.createRoot(document.getElementById("root")).render(t.jsx(Ue.StrictMode,{children:t.jsxs(fr,{theme:Ai,children:[t.jsx(mr,{}),t.jsx(jr,{children:t.jsx(Za,{children:t.jsx(Ri,{})})})]})}));
